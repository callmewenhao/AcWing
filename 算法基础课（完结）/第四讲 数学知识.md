#! https://zhuanlan.zhihu.com/p/654256693
# æ•°è®º

## é¢„å¤‡çŸ¥è¯†ï¼š

### 0. è°ƒå’Œçº§æ•°ï¼š

$1 + \frac{1}{2} +  \frac{1}{3}+ \cdots + \frac{1}{n} = ln(n)$

### 1. è´¹é©¬å°å®šç†

å¦‚æœ $p$ æ˜¯ä¸€ä¸ªè´¨æ•°ï¼Œè€Œæ•´æ•° $a$ ä¸æ˜¯ $p$ çš„å€æ•°ï¼Œåˆ™æœ‰ $a^p = a \pmod p \Longrightarrow a^{p-1} \equiv 1\ \pmod p$

åº”ç”¨ä¸¾ä¾‹ï¼šè®¡ç®— $2^{100}\ \bmod 13$

è§£ï¼š
ç”±è´¹é©¬å°å®šç†å¯çŸ¥ï¼Œ$a^{12} \equiv 1\ \pmod{13}$ï¼Œå½“ $a=12$ æ—¶ï¼Œæœ‰
$$
2^{100}\ \bmod 13 = 2^{12 * 8 + 4}\ \bmod 13 = 2^{12 * 8} * 2^4\ \bmod 13 = (2^{12})^8 * 2^4\ \bmod 13 = 1 * 16\ \bmod 13 = 3
$$

### 2. è£´èœ€å®šç†

å¯¹äºä»»ä½•æ•´æ•° $a,\ b$ å’Œä»–ä»¬çš„æœ€å¤§å…¬çº¦æ•° $gcd(a, b) = d$ï¼Œé‚£ä¹ˆå¯¹äºä»»æ„çš„æ•´æ•° $x,\ y,\ ax+by$ éƒ½ä¸€å®šæ˜¯ $d$ çš„å€æ•°ï¼Œç‰¹åˆ«åœ°ï¼Œä¸€å®šå­˜åœ¨æ•´æ•° $x,\ y$ï¼Œä½¿ $ax+by=d$ æˆç«‹ã€‚ä¸€ä¸ªé‡è¦æ¨è®ºæ˜¯ï¼š$a,\ b$ äº’è´¨çš„**å……åˆ†å¿…è¦æ¡ä»¶**æ˜¯å­˜åœ¨æ•´æ•° $x,\ y$ ä½¿ $ax+by=1$


## è´¨æ•°

åœ¨å¤§äº 1 çš„æ•´æ•°ä¸­ï¼Œå¦‚æœåªåŒ…å« 1 å’Œæœ¬èº«è¿™ä¸¤ä¸ªçº¦æ•°ï¼Œå°±è¢«ç§°ä¸ºè´¨æ•°ï¼Œæˆ–è€…å«ç´ æ•°

**è´¨æ•°å®šç†**ï¼š$[1,\ n]$ ä¸­æœ‰ $\frac{n}{ln(n)}$ ä¸ªè´¨æ•°

### è´¨æ•°çš„åˆ¤å®šâ€”â€”è¯•é™¤æ³•

ä» $2$ åˆ° $n-1$ çœ‹èƒ½å¦å‡ºç° $n$ çš„é™¤æ•°ï¼Œå¦‚æœæœ‰åˆ™è¡¨æ˜ $n$ ä¸æ˜¯è´¨æ•°ã€‚

ä¼˜åŒ–ï¼šçº¦æ•°æ€»æ˜¯æˆå¯¹å‡ºç°ï¼Œæ¯”å¦‚ï¼š$b$ å’Œ $n/b$ï¼Œæ‰€ä»¥åªéœ€è¦æšä¸¾åˆ° $b$ çš„æœ€å¤§å€¼å°±è¡Œï¼Œä¹Ÿå°±æ˜¯ï¼š$b = n/b => b = sqrt(n)$ã€‚æ—¶é—´å¤æ‚åº¦ï¼š**ä¸¥æ ¼æ„ä¹‰ä¸Šçš„** `O(sqrt(n))`

```C++
// yæ€»æ¨èçš„å†™æ³• ä¸ä¼šæº¢å‡ºã€ä¹Ÿä¸è€—æ—¶
bool is_prime(int a) {
    if (a < 2) return false;
    for (int i = 2; i <= a / i; i++) {
        if (a % i == 0) return false;
    }
    return true;
}
```
###  åˆ†è§£è´¨å› æ•°â€”â€”è¯•é™¤æ³•

æ€§è´¨ï¼š$n$ ä¸­æœ€å¤šåªåŒ…å«ä¸€ä¸ªå¤§äº $sqrt(n)$ çš„è´¨å› å­ï¼Œæ¯”å¦‚ï¼š$n=15$ æ—¶ï¼ŒåªåŒ…å«ä¸€ä¸ªå¤§äº $sqrt(15)$ çš„è´¨å› å­ $5$ã€‚

æ—¶é—´å¤æ‚åº¦ï¼š**å¹¶ä¸æ˜¯ä¸¥æ ¼æ„ä¹‰ä¸Šçš„** `O(sqrt(n))`ï¼Œæ¯”å¦‚ï¼š$n = 2^x$ æ—¶ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ $log(n)$ã€‚

```C++
void divide(int a) {
    for (int i = 2; i <= a / i; i++) {
        if (a % i == 0) {
            int s = 0;
            // æŠŠè¿™ä¸ªè´¨å› å­ä¸æ–­é™¤æ‰
            while (a % i == 0) {
                a /= i;
                s++;
            }
            cout << i << " " << s << endl;
        }
    }
    // å¤„ç†å¤§äº sqrt(n) çš„è´¨å› å­
    if (a > 1) cout << a << " " << 1 << endl;
    cout << endl;
}
```

### ç­›è´¨æ•°

#### åŸƒæ°ç­›æ³•

æ—¶é—´å¤æ‚åº¦ï¼š`O(n*loglogn)`

```C++
const int N = 1e6 + 7;
int cnt, primes[N];
bool st[N]; // ä¸æ˜¯è´¨æ•°
// åŸƒæ°ç­›æ³•
void get_primes(int n) {
    // è´¨æ•°ä» 2 å¼€å§‹
    for (int i = 2; i <= n; i++) {
        // æ˜¯è´¨æ•°
        if (!st[i]) {
            primes[cnt++] = i;
            // æŠ¹æ‰è´¨æ•°çš„å€æ•°
            for (int j = 2 * i; j <= n; j += i) {
                st[j] = true;
            }
        }
    }
}
```

#### çº¿æ€§ç­›æ³•

ç”¨æ¯ä¸€ä¸ª**åˆæ•°**çš„**æœ€å°è´¨å› å­**ç­›ï¼ˆä»£ç ä¿è¯äº†è¿™ä¸€ç‚¹ï¼‰ï¼Œç”±äºæ¯ä¸ªæ•°åªæœ‰ä¸€ä¸ªæœ€å°è´¨å› å­ï¼Œæ‰€ä»¥æ¯ä¸€ä¸ªæ•°éƒ½èƒ½è¢«ç­›æ‰ï¼Œä¸”åªä¼šè¢«ç­›ä¸€æ¬¡ï¼Œå› æ­¤è¯¥ç®—æ³•ç§°ä¸º**çº¿æ€§ç­›**ğŸ˜Šã€‚

æ—¶é—´å¤æ‚åº¦ï¼š`O(n)`

```C++
// çº¿æ€§ç­›
void get_primes(int n) {
    for (int i = 2; i <= n; i++) {
        // å½“å‰æ˜¯è´¨æ•°
        if (!st[i]) primes[cnt++] = i;
        // ä½¿ç”¨å·²æœ‰çš„è´¨æ•° å’Œ i ç­›åˆæ•°
        for (int j = 0; primes[j] <= n / i; j++) { // ä¿è¯ä½¿ç”¨æœ€å°è´¨å› å­ç­›åˆæ•°
            st[primes[j] * i] = true;
            // ä¿è¯ä½¿ç”¨æœ€å°è´¨å› å­ç­›åˆæ•°
            if (i % primes[j] == 0) break;
        }
    }
}
```

## çº¦æ•°

### è¯•é™¤æ³•æ±‚çº¦æ•°

æ—¶é—´å¤æ‚åº¦ï¼š`O(sqrt(n))`

```C++
// ä¸è¯•é™¤æ³•æ±‚è´¨æ•°ä¸€æ ·çš„
vector<int> get_divisors(int a) {
    vector<int> res;
    for (int i = 1; i <= a / i; i++) {
        if (a % i == 0) {
            // çº¦æ•°æˆå¯¹å‡ºç°ï¼Œéœ€è¦åˆ¤é‡
            res.push_back(i);
            if (i != a / i) {
                res.push_back(a / i);
            }
        }
    }
    sort(res.begin(), res.end());
    return res;
}
```

### çº¦æ•°ä¸ªæ•°

> åœ¨ `int` èŒƒå›´å†…ï¼ˆ-2e9ï½2e9ï¼‰ï¼Œçº¦æ•°æœ€å¤šçš„æ•°æœ‰ 1536 ä¸ªçº¦æ•°ã€‚

å°†ä¸€ä¸ªæ•° $a$ åˆ†è§£è´¨å› æ•°ï¼š$a = p_{1} ^ {\alpha_1} * p_{2} ^ {\alpha_2} * p_{3} ^ {\alpha_3} * \cdots * p_{k} ^ {\alpha_k}$

åˆ™ $a$ çš„çº¦æ•°ä¸ªæ•°ä¸ºï¼š$(\alpha_1 + 1) * (\alpha_2 + 1) * (\alpha_3 + 1)* \cdots * (\alpha_k+ 1)$

è¯æ˜ï¼š**ä¹˜æ³•åŸç†**

ä¸¾ä¾‹ï¼š$a = 12 = 2^2 + 3^1$ï¼Œåˆ™ $a$ çš„**çº¦æ•°ä¸ªæ•°**ä¸ºï¼š$(2 + 1) * (1 + 1) = 3 * 2 = 6$

```C++
int n;
unordered_map<int, int> primes;

int main() {
    cin >> n;
    int x;
    while (n--) {
        cin >> x;
        for (int i = 2; i <= x / i; i++) {
            while (x % i == 0) {
                x /= i;
                primes[i]++;
            }
        }
        if (x > 1) primes[x]++;
    }

    // è®¡ç®—ä¸ªæ•°
    LL ans = 1;
    for (auto [k, v]: primes) {
        ans = ans * (v + 1) % MOD;
    }
    cout << ans << endl;
    return 0;
}
```

### çº¦æ•°ä¹‹å’Œ

å°†ä¸€ä¸ªæ•° $a$ åˆ†è§£è´¨å› æ•°ï¼š$a = p_{1} ^ {\alpha_1} * p_{2} ^ {\alpha_2} * p_{3} ^ {\alpha_3} * \cdots * p_{k} ^ {\alpha_k}$

åˆ™ $a$ çš„çº¦æ•°ä¹‹å’Œä¸ºï¼š$(p_{1}^0 + p_{1}^1 + \cdots + p_{1}^{\alpha_1}) * (p_{2}^0 + p_{2}^1 + \cdots + p_{2}^{\alpha_2}) * \cdots * (p_{k}^0 + p_{k}^1 + \cdots + p_{k}^{\alpha_k})$

ä¸¾ä¾‹ï¼š$a = 12 = 2^2 + 3^1$ï¼Œåˆ™ $a$ çš„**çº¦æ•°ä¹‹å’Œ**ä¸ºï¼š$(2^0 + 2^1 + 2^2) * (3^0 + 3^1) = 7 * 4 = 28
$

```C++
// çº¦æ•°ä¹‹å’Œ
int n;
unordered_map<int, int> cnt;

int main() {
    
    cin >> n;
    while (n--) {
        int x;
        cin >> x;
        
        for (int i = 2; i <= x / i; i++) {
            if (x % i == 0) {
               int t = 0;
               while (x % i == 0) {
                   t++;
                   x/=i;
               }
               cnt[i] += t;
            }
        }
        if (x > 1) cnt[x]++;
    }
    
    int res = 1;
    for (auto [p, a]: cnt) {
        int t = 1;
        while (a--) {
            t = (1ll * p * t + 1) % MOD;  // MOD éœ€è¦ç»Ÿä¸€
        }
        res = 1ll * res * t % MOD;
    }
    cout << res;
    
    return 0;
}
```

### æœ€å¤§å…¬çº¦æ•°â€”â€”æ¬§å‡ é‡Œå¾—ç®—æ³•

æ¬§å‡ é‡Œå¾—ç®—æ³•åˆå« **è¾—è½¬ç›¸é™¤ç®—æ³•**ï¼Œè®¡ç®—å…¬å¼ $gcd(a,\ b) = gcd(b,\ a\bmod b)$

æ—¶é—´å¤æ‚åº¦ï¼š`O(logn)`

```C++
// a b çš„å¤§å°å…¶å®æ— æ‰€è°“
int gcd(int a, int b) {
    return b ? gcd(b, a % b) : a;
}
```

## æ¬§æ‹‰å‡½æ•°

### å•ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°

> äº’è´¨å®šä¹‰ï¼šä¸¤ä¸ªæ•°**æ²¡æœ‰**é™¤äº† 1 ä»¥å¤–çš„å…¶ä»–å…¬çº¦æ•°ç§°ä¸ºäº’è´¨ï¼Œä¾‹å¦‚ï¼š5 å’Œ 6 äº’è´¨
> 
> 1 ä¸ä»»ä½•æ­£æ•´æ•°ï¼ˆåŒ…æ‹¬ 1 æœ¬èº«ï¼‰éƒ½æ˜¯äº’è´¨

æ¬§æ‹‰å‡½æ•°å®šä¹‰ï¼š$[1, n)$ ä¸­ä¸ $n$ äº’è´¨çš„æ•°çš„ä¸ªæ•°ï¼Œä¸¾ä¾‹ï¼š$\varphi(6) = 2 = \{1, 5\}$ã€‚ç‰¹æ®Šçš„ï¼Œä¸€ä¸ªè´¨æ•° $n$ çš„æ¬§æ‹‰å‡½æ•°å€¼æ˜¯ $n-1$

å°†ä¸€ä¸ªæ•° $a$ åˆ†è§£è´¨å› æ•°ï¼š$a = p_{1} ^ {\alpha_1} * p_{2} ^ {\alpha_2} * p_{3} ^ {\alpha_3} * \cdots * p_{k} ^ {\alpha_k}$ï¼Œåˆ™å…¶**æ¬§æ‹‰å‡½æ•°å€¼**ä¸ºï¼š$\varphi(a) = a(1-\frac{1}{p_{1}})(1-\frac{1}{p_{2}})\cdots(1-\frac{1}{p_{k}})$ï¼Œæ—¶é—´å¤æ‚åº¦ï¼šä¸åˆ†è§£è´¨å› æ•°ç›¸åŒï¼Œä¸æ˜¯ä¸¥æ ¼æ„ä¹‰ä¸Šçš„ `O(sqrt(n))`

å€ŸåŠ©**å®¹æ–¥åŸç†**è§£é‡Šï¼š

1. ä» 1~N ä¸­ï¼ˆä¸€å…± `n` ä¸ªæ•°ï¼‰å»æ‰ p1ï¼Œp2ï¼Œ...ï¼Œpk çš„æ‰€æœ‰å€æ•° `-n/p1 -n/p2 - ...`
2. åŠ ä¸Šæ‰€æœ‰ pi * pj çš„å€æ•° `+n/(p1*p2) +n/(p1*p3)...`
3. å‡å»æ‰€æœ‰ pi * pj * pk çš„å€æ•° `-n/(p1*p2*p3) -n/(p1*p3*p4)...`
4. ...

```C++
int res = a;
for (int i = 2; i <= a / i; i++) {
    if (a % i == 0) {
        // ä¸ºäº†é˜²æ­¢å‡ºç°å°æ•°å¼ºè½¬æ•´æ•°çš„æƒ…å†µ
        res = res / i * (i - 1);  // å…ˆé™¤å†ä¹˜é˜²æ­¢çˆ† int
        while (a % i == 0) {
            a /= i;
        }
    }
}
// æœ€åçš„è´¨æ•°å¤„ç†
if (a > 1) res = res / a * (a - 1); // æ³¨æ„è¿™é‡Œ res è¿˜æ˜¯ a çš„å€æ•° æ‰€ä»¥å¯ä»¥å…ˆé™¤ï¼Œä¸ç„¶ä¸èƒ½å…ˆé™¤
```

### ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•°

æ±‚å‡º $[1, n]$ ä¸­æ¯ä¸€ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°å€¼ã€‚å¦‚æœå¯¹æ¯ä¸€ä¸ªæ•°æ±‚æ¬§æ‹‰å‡½æ•°ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ `O(n*sqrt(n))`ï¼Œå€ŸåŠ©ä¹‹å‰çº¿æ€§ç­›æ³•ï¼Œå®ç°ä¸€ä¸ª `O(n)` çš„ç®—æ³•ã€‚æ ¸å¿ƒæ€æƒ³å’Œçº¿æ€§ç­›ä¸€è‡´ï¼šå€ŸåŠ©å·²ç»æ±‚å‡ºæ¥çš„æ¬§æ‹‰å‡½æ•°å€¼æ›´æ–°åé¢çš„æ¬§æ‹‰å‡½æ•°å€¼

```C++
phi[1] = 1; // 1 çš„æ¬§æ‹‰å‡½æ•°å€¼è¢«å®šä¹‰ä¸º 1
for (int i = 2; i <= n; i++) {
    if (!st[i]) {
        primes[cnt++] = i;
        // è´¨æ•°çš„æ¬§æ‹‰å‡½æ•°å€¼æ˜¯ i-1
        phi[i] = i - 1;
    }
    for (int j = 0; primes[j] <= n / i; j++) {
        st[primes[j] * i] = true;
        if (i % primes[j] == 0) {
            // å½“ pj æ˜¯ i çš„è´¨å› å­æ—¶
            // phi[i] å·²ç»åŒ…å« (1 - 1/pj)
            // phi[pj * i] å°±æ˜¯ phi[i] * pj
            phi[primes[j] * i] = phi[i] * primes[j];
            break;
        }
        // å½“ pj ä¸æ˜¯ i çš„è´¨å› å­æ—¶
        // phi[pj * i] = phi[i] * pj * (1 - 1/pj) = phi[i] *(pj - 1)
        phi[primes[j] * i] =  phi[i] * (primes[j] - 1); // è¿™ä¸ªæ˜¯å…¬å¼åŒ–ç®€åçš„ç»“æœ
    }
}
```

## å¿«é€Ÿå¹‚

å¿«é€Ÿå¹‚åˆå«äºŒè¿›åˆ¶å–å¹‚ï¼ˆBinary Exponentiationï¼Œä¹Ÿç§°å¹³æ–¹æ³•ï¼‰ï¼Œå¿«é€Ÿåœ°æ±‚å‡º $a^k\  \bmod \ p$ çš„ç»“æœï¼Œæ—¶é—´å¤æ‚åº¦ï¼š`O(logk)`ï¼Œå…¶ä¸­ï¼Œ$1 <= a, p, k <= 1e9$

å€ŸåŠ© $k$ çš„äºŒè¿›åˆ¶è¡¨ç¤ºï¼Œä¼˜åŒ–æ±‚å– $a^k\  \bmod \ p$ çš„è¿‡ç¨‹ã€‚æŠŠ $a^k$ ä¸­çš„ k æ‹†æˆäºŒè¿›åˆ¶è¡¨ç¤ºï¼š$k = 2^0 + 2^1 + \cdots + 2^i$ï¼Œæˆ‘ä»¬åªè¦èƒ½è®¡ç®—å‡º $a^{2^i}\ \bmod \ p$ ï¼Œå°±èƒ½ `logk` çš„è®¡ç®—å‡º $a^k\  \bmod \ p$ çš„ç»“æœ

```C++
int res = 1;
while (k) {
    // å¯¹åº”çš„ä½ç½®ä¸º 1
    if (k & 1) res = (LL)res * a % p;
    k >>= 1;
    a = (LL) a * a % p;  // å¹³æ–¹ä¸€ä¸‹
}
return res;
```

```java
private int qmi(int a, int b, int p) {
    int res = 1;
    for (; b > 0; b /= 2) {
        if (b % 2 == 1) res = (int) (1l * res * a % p);
        a = (int) (1l * a * a % p);
    }
    return res;
}
```

### å¿«é€Ÿå¹‚æ±‚é€†å…ƒ

> AcWingçš„**æ¨¡æ„ä¹‰ä¸‹ä¹˜æ³•é€†å…ƒ**çš„å®šä¹‰ï¼š
> 
> è‹¥æ•´æ•° $bï¼Œm$ äº’è´¨ï¼Œå¹¶ä¸”å¯¹äºä»»æ„æ•´æ•° $a$ï¼Œå¦‚æœæ»¡è¶³ $b|a$ï¼ˆ$b$ æ•´é™¤ $a$ï¼‰ï¼Œåˆ™å­˜åœ¨ä¸€ä¸ªæ•´æ•° $x$ï¼Œä½¿å¾— $a/bâ‰¡aÃ—x(\%\ m)$ï¼Œåˆ™ç§° $x$ ä¸º $b$ çš„æ¨¡ $m$ ä¹˜æ³•é€†å…ƒï¼Œè®°ä¸º $b^{âˆ’1}(mod\ m)$ã€‚

æ›´å¥½ç†è§£çš„**æ¨¡æ„ä¹‰ä¸‹ä¹˜æ³•é€†å…ƒ**çš„å®šä¹‰ï¼š

å¦‚æœä¸€ä¸ªçº¿æ€§åŒä½™æ–¹ç¨‹ $ax \equiv 1 \pmod b$ï¼Œåˆ™ $x$ ç§°ä¸º $a \bmod b$ çš„é€†å…ƒï¼Œè®°ä½œ $a^{-1}$ã€‚

$a$ å­˜åœ¨ä¹˜æ³•é€†å…ƒçš„å……è¦æ¡ä»¶æ˜¯ $a$ ä¸æ¨¡æ•° $b$ äº’è´¨ï¼ˆä¹Ÿå°±æ˜¯è¯´å½“ $a$ æ˜¯ $b$ çš„è¢«å€æ•°æ—¶ï¼Œä¸å­˜åœ¨é€†å…ƒï¼‰ã€‚å½“æ¨¡æ•° $b$ ä¸ºè´¨æ•°æ—¶ï¼Œç”±é¢„å¤‡çŸ¥è¯†**è´¹é©¬å°å®šç†**ï¼Œ$a^{bâˆ’2} (mod\ b)$ å³ä¸º $a$ çš„ä¹˜æ³•é€†å…ƒã€‚æ¨å¯¼ï¼š$a^{b-1} = 1 (\%b)  \ =>\ a * a^{b-2} = 1 (\%b)$ï¼Œæ‰€ä»¥ä¹˜æ³•é€†å…ƒçš„æœ¬è´¨å°±æ˜¯ä¸€ä¸ªå¿«é€Ÿå¹‚çš„è®¡ç®—ã€‚

**æ³¨æ„å¯¹æ¯”**ï¼šå¿«é€Ÿå¹‚æ³•ä½¿ç”¨äº†è´¹é©¬å°å®šç†ï¼Œè¦æ±‚ $b$ æ˜¯ä¸€ä¸ªç´ æ•°ï¼Œè€Œæ‰©å±•æ¬§å‡ é‡Œå¾—æ³•åªè¦æ±‚ $gcd(a, b) = 1$

```C++
int res = qmi(a, p-2, p);
// è¦å…ˆåˆ¤æ–­æ˜¯å¦æœ‰é€†å…ƒ
if (a % p) cout << res << endl;
else cout << "impossible" << endl;
```

## æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•

### è£´èœ€å®šç†ä¸­çš„ x å’Œ y

æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼šåœ¨ä½¿ç”¨ **æ¬§å‡ é‡Œå¾—ç®—æ³•** è®¡ç®— gcd çš„æ—¶å€™ï¼Œé¡ºä¾¿è®¡ç®—å‡º **è£´èœ€å®šç†** ä¸­çš„ x å’Œ yã€‚æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•æ˜¯å€ŸåŠ© **è£´èœ€å®šç†**ï¼Œåœ¨é€’å½’è°ƒç”¨å‰åï¼Œé€šè¿‡ gcd ç›¸ç­‰ï¼Œæ„é€ ä¸€ä¸ªç­‰å¼ï¼Œç„¶åæ±‚è§£å‡ºå½“å‰çš„ x å’Œ y

**å…¬å¼æ¨å¯¼**ï¼š

ç”± **æ¬§å‡ é‡Œå¾—ç®—æ³•** å¯çŸ¥ï¼Œexgcd(a, b, x, y) = d = exgcd(b, a % b, y, x)

å†æ ¹æ® **è£´èœ€å®šç†**ï¼Œç¬¬ä¸€ä¸ªå¼å­æ¨å‡º $a*x + b*y = d$ï¼Œç¬¬äºŒä¸ªå¼å­æ¨å‡º $(a\bmod b)*x' + b*y' = d$ï¼Œä»è€Œå¾—åˆ°ç­‰å¼ï¼š$a*x + b*y = (a\bmod b)*x' + b*y'$

å‡è®¾ $a\bmod b = a - k*b, k=a/b$ï¼Œåˆ™ $(a\bmod b)*x' + b*y' = (a - k * b)*x' + b*y' = a*x' + b*(y'-k*x')$ï¼Œæ•…æœ‰ï¼Œ$a*x + b*y = a*x' + b*(y'-k*x')$ï¼Œæ ¹æ®å¯¹åº”ç³»æ•°ç›¸ç­‰ï¼Œå¾—æ›´æ–°å…¬å¼ï¼š

$$
x = x' \\
y = y'-k*x' = y' -a/b * x'
$$

åœ¨å‡½æ•°å®ç°æ—¶ï¼Œå…ˆé€šè¿‡é€’å½’è°ƒç”¨ exgcd(b, a % b, y, x) è®¡ç®—å‡ºäº† $x'\ y'$ï¼Œå†é€šè¿‡æ›´æ–°å…¬å¼è®¡ç®—å‡º $x\ y$

```C++
int exgcd(int a, int b, int &x, int &y) {
    if (!b) {
        x = 1, y = 0;
        return a;
    }
    int d = exgcd(b, a % b, y, x);
    // x ä¸å˜
    // y æ›´æ–°
    y -= a / b * x;
    return d;
}

// ä¸€ä¸ªæ›´å¥½ç†è§£å¾—ä»£ç ç‰ˆæœ¬
int exgcd(int a, int b, int &x, int &y) {
    if (!b) {
        x = 1, y = 0;
        return a;
    }
    int x_ = 0, y_ = 0;
    int d = exgcd(b, a % b, y_, x_);
    x = x_;
    y = y_ -  a / b * x_;
    return d;
}
```

### çº¿æ€§åŒä½™æ–¹ç¨‹

å¯¹äºç»™å®šçš„ $a, b,m$ï¼Œæ±‚ä¸€ä¸ªæ•° $x$ ä½¿å¾— $a * x = b\pmod m$ï¼Œè¿™ç§æ–¹ç¨‹ç§°ä¸ºçº¿æ€§åŒä½™æ–¹ç¨‹ï¼Œæ³¨æ„æ–¹ç¨‹å¯èƒ½æ— è§£ã€‚


**å…¬å¼æ¨å¯¼**ï¼š

å€ŸåŠ© **æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•** æ±‚è§£ï¼Œæ–¹ç¨‹ $a*x = b\pmod m$ å…ˆè½¬åŒ–ä¸º $a*x = m*y + b$ï¼Œå†ç§»é¡¹ä¸º $a*x - m*y = b$ï¼Œç”±äº $y$ å¯ä»¥å–è´Ÿå€¼ï¼Œå› æ­¤æŠŠè´Ÿå·æ”¾å…¥ $y$ ä¸­å¾—åˆ° $a*x + m*y = b$

å¯¹äºå¼å­ $a*x' + m*y' = gcd(a, m)$ ä¸­çš„ $x'$ å¯ä»¥ä½¿ç”¨ **æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•** è®¡ç®—ï¼Œåˆ™æ‰€æ±‚çš„ $x$ å°±æ˜¯ **æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•** çš„è§£ $x'$ çš„ $b\ /\ gcd(a, m)$ å€

æ˜¾ç„¶ï¼Œæ–¹ç¨‹æœ‰è§£çš„å‰ææ˜¯ï¼š$b$ å¯ä»¥æ•´é™¤ $gcd(a, m)$ï¼Œä¹Ÿå°±æ˜¯ $b$ å¿…é¡»æ˜¯ $gcd(a, m)$ çš„å€æ•°

```C++
int d = exgcd(a, m, x, y);
if (b % d) cout << "impossible" << endl;
else cout << (LL) x * (b / d) % m << endl;  // æœ€åè¿˜éœ€è¦ mod m
```

### æ‰©å±•æ¬§å‡ é‡Œå¾—æ±‚é€†å…ƒ

æ±‚ $a \bmod b$ æ„ä¹‰ä¸‹çš„é€†å…ƒ $x$ï¼Œå‰ææ˜¯ $a$ å’Œ $b$ äº’è´¨ï¼š$gcd(a, b) = 1$ï¼Œå…¬å¼æ¨å¯¼å¦‚ä¸‹ï¼š

$$
a * x \equiv 1 \pmod b \\
a * x \equiv b * y' + 1 \pmod b \\
a * x - b * y'\equiv 1 \pmod b \\
a * x + b * y\equiv 1 \pmod b \\
$$

æ•…ï¼Œ$a \bmod b$ æ„ä¹‰ä¸‹çš„é€†å…ƒ $x$ å°±æ˜¯ `exgcd` ä¸­çš„å‚æ•° `x`


## ä¸­å›½å‰©ä½™å®šç†

ä¸­å›½å‰©ä½™å®šç† (Chinese Remainder Theorem, CRT) å¯æ±‚è§£**å¦‚ä¸‹å½¢å¼ï¼ˆå’Œå‰é¢çš„çº¿æ€§åŒä½™æ–¹ç¨‹å½¢å¼ä¸åŒï¼‰çš„ä¸€å…ƒçº¿æ€§åŒä½™æ–¹ç¨‹ç»„**ï¼ˆå…¶ä¸­ $n_1$, $n_2$, $\cdots$, $n_k$ **ä¸¤ä¸¤äº’è´¨ï¼Œä½†ä¸ä¿è¯å…¨éƒ¨æ˜¯è´¨æ•°**ï¼‰ï¼š

$$
\begin{cases}
    &x \equiv a_1\ (mod\ n_1) \\
    &x \equiv a_2\ (mod\ n_2) \\
    & \vdots\\
    &x \equiv a_k\ (mod\ n_k) \\
\end{cases}
$$

æ±‚è§£è¿‡ç¨‹ï¼š

1. è®¡ç®—æ‰€æœ‰æ¨¡æ•°çš„ç§¯ $n$
2. å¯¹äºç¬¬ i ä¸ªæ–¹ç¨‹ï¼š
    - è®¡ç®— $m_i = \frac{n}{n_i}$ï¼Œè¿™å°±æ„å‘³ç€ $m_i$ ä¸ $n_i$ äº’è´¨
    - è®¡ç®— $m_i$ åœ¨æ¨¡ $n_i$ æ„ä¹‰ä¸‹çš„é€†å…ƒ $m_i^{-1}$ï¼Œå€ŸåŠ©æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•æ±‚é€†å…ƒ
    - è®¡ç®— $c_i = m_i*m_i^{-1}$ ï¼ˆä¸è¦å¯¹ $n_i$ å–æ¨¡ï¼‰
3. æ–¹ç¨‹ç»„åœ¨æ¨¡ $n$ æ„ä¹‰ä¸‹çš„å”¯ä¸€è§£ä¸ºï¼š$x = \sum_{i=1}^{k}a_ic_i\ (mod\ n)$ 

[è¿™ä¸ªé¢˜ç›®](https://www.acwing.com/problem/content/206/) å¹¶ä¸æ»¡è¶³ä¸­å›½å‰©ä½™å®šç†ä¸­äº’è´¨çš„æ¡ä»¶ï¼Œéœ€è¦è¿›è¡Œé¢å¤–çš„å¤„ç†

## é«˜æ–¯æ¶ˆå…ƒ

### é«˜æ–¯æ¶ˆå…ƒè§£çº¿æ€§æ–¹ç¨‹ç»„

åœ¨ `n^3` æ—¶é—´å†…ï¼Œè®¡ç®—å‡ºä¸€ä¸ªåŒ…å« `n` ä¸ªæ–¹ç¨‹ `n` ä¸ªæœªçŸ¥æ•°çš„çº¿æ€§æ–¹ç¨‹ç»„ï¼ˆæ–¹ç¨‹ç»„ä¸­çš„ç³»æ•°ä¸º**å®æ•°**ï¼‰ã€‚

ä¸€ä¸ªåŒ…å« `m` ä¸ªæ–¹ç¨‹ `n` ä¸ªæœªçŸ¥æ•°çš„çº¿æ€§æ–¹ç¨‹ç»„ç¤ºä¾‹

$$
\begin{cases}
    & a_{11} x_1 + a_{12} x_2 + \cdots + a_{1n} x_n = b_1 \\
    & a_{21} x_1 + a_{22} x_2 + \cdots + a_{2n} x_n = b_2 \\
    & \cdots \\
    & a_{m1} x_1 + a_{m2} x_2 + \cdots + a_{mn} x_n = b_m \\
\end{cases}
$$

é«˜æ–¯æ¶ˆå…ƒï¼šé€šè¿‡ä¸‹é¢çš„ä¸‰ç§æ“ä½œå°†å¢å¹¿çŸ©é˜µåŒ–ç®€æˆè¡Œæœ€ç®€å½¢å¼ï¼ˆä¸Šä¸‰è§’å½¢å¼ï¼‰

- æŸè¡Œä¹˜éé›¶çš„æ•°
- äº¤æ¢æŸä¸¤è¡Œ
- æŠŠæŸè¡Œè‹¥å¹²å€åŠ åˆ°å¦ä¸€è¡Œä¸Šå»

æ–¹ç¨‹ç»„è§£çš„æƒ…å†µï¼š

- æ— è§£ï¼ˆ0è¡Œç­‰äºéé›¶è¡Œï¼‰
- æ— ç©·ç»„è§£ï¼ˆ0ç­‰äº0ï¼Œå­˜åœ¨å¤šä½™æ–¹ç¨‹ï¼‰
- å”¯ä¸€è§£ï¼ˆå®Œç¾é˜¶æ¢¯å‹ï¼‰

å…·ä½“æ­¥éª¤ï¼š

- æšä¸¾æ¯ä¸€åˆ— cï¼Œæ‰¾åˆ°ç»å¯¹å€¼æœ€å¤§çš„è¡Œ
- æŠŠè¿™ä¸€è¡Œæ¢åˆ°æœ€ä¸Šé¢å»
- å°†è¯¥è¡Œçš„çš„ç¬¬ 1 æ•°å˜æˆ 1
- æŠŠä¸‹é¢æ‰€æœ‰è¡Œçš„ç¬¬ c åˆ—æ¶ˆæˆ 0
- æœ€åä»ä¸‹åˆ°ä¸Šè¿›è¡Œæ±‚è§£

```C++
// è¿”å›å€¼ 
// 0ï¼šå”¯ä¸€è§£
// 1ï¼šæ— ç©·è§£
// 2ï¼šæ— è§£
int gauss() {
    int c, r;
    // æšä¸¾æ¯ä¸€åˆ— c
    for (c = 0, r = 0; c < n; c++) {
        // æ‰¾åˆ°ç»å¯¹å€¼æœ€å¤§çš„è¡Œ
        int t = r; // ä»å½“å‰è¿™ä¸€è¡Œå¼€å§‹å‘ä¸‹æ‰¾
        for (int i = r; i < n; i++)
            if (fabs(a[i][c]) > fabs(a[t][c]))
                t = i;
        // å¦‚æœæ‰¾åˆ°çš„å½“å‰è¡Œåˆ—æ˜¯ 0 ï¼ˆå°äºç²¾åº¦ï¼‰
        if (fabs(a[t][c]) < eps) continue;
        // ä¸æ˜¯ 0 å°±äº¤æ¢
        for (int i = c; i <= n; i++) swap(a[t][i], a[r][i]);  // ç­‰å·å³ä¾§çš„å€¼ä¹Ÿè¦äº¤æ¢
        // å°†è¯¥è¡Œçš„çš„ç¬¬ 1 æ•°å˜æˆ 1 æ³¨æ„è¦ä»åå‘å‰è¿ç®—ï¼Œé˜²æ­¢è¦†ç›–
        for (int i = n; i >= c; i--) a[r][i] /= a[r][c];
        // æŠŠä¸‹é¢æ‰€æœ‰è¡Œçš„ç¬¬ c åˆ—æ¶ˆæˆ 0
        for (int i = r + 1; i < n; i++) 
            // å¦‚æœå·²ç»æ˜¯ 0 äº†ï¼Œå°±ä¸ç”¨å‡äº†
            // å¦åˆ™éœ€è¦å‡å»
            if (fabs(a[i][c]) > eps) 
                // è¿˜æ˜¯è¦ä»åå‘å‰è¿ç®—ï¼Œé˜²æ­¢è¦†ç›–
                for (int j = n; j >= c; j--)
                    a[i][j] -= a[r][j] * a[i][c];
        r++;
    }
    // è§£çš„æƒ…å†µ
    if (r < n) {
        //åˆ¤æ–­æ˜¯å¦æ— è§£
        for (int i = r; i < n; i++) {
            //å¦‚æœç­‰å¼å³è¾¹ä¸æ˜¯ 0
            if (fabs(a[i][n]) > eps) return 2;  // æ— è§£
        }
        // æœ‰æ— ç©·è§£
        return 1;
    }
    // æ±‚è§£è¿‡ç¨‹ï¼Œæ¶ˆå…ƒ
    for (int i = n - 1; i >= 0; i--) {
        for (int j = i + 1; j < n; j++) 
            a[i][n] -= a[i][j] * a[j][n];  // ç­”æ¡ˆå­˜å‚¨åœ¨ a[i][n] ä¸­
    }
    return 0;
}
```

### é«˜æ–¯æ¶ˆå…ƒè§£å¼‚æˆ–çº¿æ€§æ–¹ç¨‹ç»„

å¼‚æˆ–è¿ç®—åˆ«åï¼šä¸è¿›ä½çš„åŠ æ³•

å¼‚æˆ–çº¿æ€§æ–¹ç¨‹ç»„ç¤ºä¾‹å¦‚ä¸‹ï¼šæ–¹ç¨‹ç»„ä¸­çš„ç³»æ•°å’Œå¸¸æ•°ä¸º 0 æˆ– 1 ï¼Œæ¯ä¸ªæœªçŸ¥æ•°çš„å–å€¼ä¹Ÿä¸º 0 æˆ– 1

$$
\begin{cases}
    & m_{11} x_1 \oplus m_{12} x_2 \oplus \cdots \oplus m_{1n} x_n = b_1 \\
    & m_{21} x_1 \oplus m_{22} x_2 \oplus \cdots \oplus m_{2n} x_n = b_2 \\
    & \cdots \\
    & m_{m1} x_1 \oplus m_{m2} x_2 \oplus \cdots \oplus m_{mn} x_n = b_m \\
\end{cases}
$$

æ€è·¯å’Œè§£ä¸€èˆ¬çš„æ–¹ç¨‹ä¸€æ ·ï¼ŒæŠŠç³»æ•°çŸ©é˜µæ¶ˆæˆä¸€ä¸ªä¸Šä¸‰è§’çŸ©é˜µï¼š

- æšä¸¾æ¯ä¸€åˆ—
- æ‰¾åˆ°éé›¶è¡Œ
- äº¤æ¢è¡Œ
- ä¸‹é¢æ¸…é›¶

å¦å¤–ï¼Œè§£çš„æƒ…å†µä¹Ÿå’Œä¹‹å‰ä¸€æ ·

```C++
int gauss() {
    int r, c;
    for (r = c = 0; c < n; c++) {
        // æ‰¾åˆ°éé›¶è¡Œ
        int t = r;
        for (int i = r; i < n; i++) {
            if (a[i][c]) {
                t = i;
                break;
            }
        }
        // åˆ¤æ–­æ‰¾åˆ°çš„ç»“æœå¯¹ä¸å¯¹
        if (!a[t][c]) continue;
        // äº¤æ¢è¡Œ
        for (int i = c; i <= n; i++) swap(a[t][i], a[r][i]);
        // ä¸‹é¢æ¸…é›¶
        for (int i = r + 1; i < n; i++)
            if (a[i][c])
                for (int j = c; j <= n; j++)
                    a[i][j] ^= a[r][j];
        r++;
    }
    // è§£çš„æƒ…å†µ
    if (r < n) {
        for (int i = r; i < n; i++)
            //å¦‚æœç­‰å¼å³è¾¹ä¸æ˜¯ 0
            if (a[i][n]) return 2;
        return 1;
    }
    // æ±‚è§£
    for (int i = n-1; i >= 0; i--)
        for (int j = i + 1; j < n; j++)
            // xi ^= aij * xj
            a[i][n] ^= a[i][j] * a[j][n];
    return 0;
}
```

## ç»„åˆæ•°

ç»„åˆæ•°å…¬å¼ï¼š

$$
C_a^b = \frac{a!}{(a-b)!b!} = \frac{a*(a-1)*\cdots*(a-b+1)}{b*(b-1)*\cdots*1} 
$$

å¦ä¸€ä¸ªé‡è¦çš„ç»„åˆæ•°å…¬å¼ï¼š$C_n^0 + C_n^1 + C_n^2 + \cdots + C_n^{n-1} + C_n^n = 2^n$ æ¨å¯¼å‡º $C_n^1 + C_n^2 + \cdots + C_n^{n-1} + C_n^n = 2^n - 1$

### ç»„åˆæ•° 1

ç»™å®š $n$ ç»„è¯¢é—®ï¼Œæ¯ç»„è¯¢é—®ç»™å®šä¸¤ä¸ªæ•´æ•° $a$ï¼Œ$b$ï¼Œè¯·ä½ è¾“å‡º $C_a^b \bmod (10^9+7)$ çš„å€¼ã€‚

æ•°æ®èŒƒå›´ï¼š

- $1 <= n <= 10000$
- $1 <= b <= a <= 2000$

å¦‚æœæš´åŠ›è®¡ç®—ï¼Œæ¯è®¡ç®—ä¸€ä¸ªç»„åˆæ•°æ—¶é—´å¤æ‚åº¦æ˜¯ 2000ï¼Œä¸€å…±æœ‰ 10000 æ¬¡è¯¢é—®ï¼Œæ€»çš„**æ—¶é—´å¤æ‚åº¦**å°±æ˜¯ 2e7ï¼Œ**ä¼šè¶…æ—¶**ï¼›æ³¨æ„åˆ° a * b æœ€å¤§ä¹Ÿå°±æ˜¯ 4e6ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ **é€’æ¨** é¢„å¤„ç†æ‰€æœ‰ç»„åˆæ•°çš„å€¼ï¼Œç„¶åå†æŸ¥è¯¢ï¼Œè¿™æ ·æ€»çš„æ—¶é—´å¤æ‚åº¦å°±æ˜¯ `n^2` = 4e6 é‡çº§ï¼Œä¸ä¼šè¶…æ—¶ã€‚

é€’æ¨å¼ï¼š$C_a^b = C_{a-1}^{b-1} + C_{a-1}^b$

```C++
for (int i = 0; i < N; i++) {
    c[i][0] = c[i][i] = 1;
    for (int j = 1; j < i; j++) {
        c[i][j] = (c[i-1][j] + c[i-1][j-1]) % mod;
    }
}
```

### ç»„åˆæ•° 2

ç»™å®š $n$ ç»„è¯¢é—®ï¼Œæ¯ç»„è¯¢é—®ç»™å®šä¸¤ä¸ªæ•´æ•° $a$ï¼Œ$b$ï¼Œè¯·ä½ è¾“å‡º $C_a^b \bmod (10^9+7)$ çš„å€¼ã€‚

æ•°æ®èŒƒå›´ï¼š

- $1 <= n <= 10000$
- $1 <= b <= a <= 1e5$

æ ¹æ®ç»„åˆæ•°å…¬å¼ï¼š$C_a^b \pmod{10^9+7}= \frac{a!}{(a-b)!b!} \pmod{10^9+7}$ï¼Œé¢„å¤„ç†å‡ºé˜¶ä¹˜ `factor` å’Œé˜¶ä¹˜çš„é€†å…ƒ `infactor`ï¼Œåˆ™ `C[a][b] = factor[a] * infactor[a-b] * infactor[b]`ï¼Œè€Œé¢„å¤„ç†é˜¶ä¹˜å’Œé˜¶ä¹˜çš„é€†å…ƒæ—¶é—´å¤æ‚åº¦ä¸ºï¼š`O(nlogn)`ï¼Œæ³¨æ„è¿ç®—è¿‡ç¨‹ä¸­ä½¿ç”¨ LL

```C++
// é¢„å¤„ç†é˜¶ä¹˜å’Œé˜¶ä¹˜é€†å…ƒ
fact[0] = infact[0] = 1;
for (int i = 1; i < N; i++) {
    fact[i] = (LL)fact[i-1] * i % mod;
    infact[i] = (LL)infact[i-1] * qmi(i, mod-2, mod) % mod;
    // è¿˜å¯ä»¥è¿™æ ·
    infact[i] = qmi(fact[i], mod-2, mod);
}
// è®¡ç®—ç»„åˆæ•°
cout << (LL)fact[a] * infact[b] % mod * infact[a - b] % mod << endl;
```

### ç»„åˆæ•° 3

ç»™å®š $n$ ç»„è¯¢é—®ï¼Œæ¯ç»„è¯¢é—®ç»™å®šä¸¤ä¸ªæ•´æ•° $a$ï¼Œ$b$ï¼Œ$p$ï¼Œå…¶ä¸­ $p$ æ˜¯è´¨æ•°ï¼Œè¯·ä½ è¾“å‡º $C_a^b \bmod p$ çš„å€¼ã€‚

æ•°æ®èŒƒå›´ï¼š

- $1 <= n <= 20$
- $1 <= b <= a <= 1e18$
- $1 <= p <= 1e5$

ä½¿ç”¨ [**å¢å¡æ–¯**](https://oi-wiki.org/math/number-theory/lucas/) å®šç†ï¼ŒLucas å®šç†ç”¨äºæ±‚è§£å¤§ç»„åˆæ•°å–æ¨¡çš„é—®é¢˜ï¼Œå…¶ä¸­æ¨¡æ•°å¿…é¡»ä¸ºè´¨æ•°ï¼Œå®šç†å…¬å¼å¦‚ä¸‹:

$$
\left(\begin{array}{c}
n \\
m
\end{array}\right) \bmod p=\left(\begin{array}{c}
\lfloor n / p\rfloor \\
\lfloor m / p\rfloor
\end{array}\right) \cdot\left(\begin{array}{c}
n \bmod p \\
m \bmod p
\end{array}\right) \bmod p
$$

```C++
// è®¡ç®—å¿«é€Ÿå¹‚
int qmi(int a, int k, int p)
{
    int res = 1;
    while (k)
    {
        if (k & 1) res = (LL)res * a % p;
        a = (LL)a * a % p;
        k >>= 1;
    }
    return res;
}

// è®¡ç®—å•æ¬¡ç»„åˆæ•°
int C(int a, int b, int p)
{
    if (b > a) return 0;
    int res = 1;
    for (int i = 1, j = a; i <= b; i ++, j -- )
    {
        res = (LL)res * j % p;
        res = (LL)res * qmi(i, p - 2, p) % p;
    }
    return res;
}

// Lucas å®šç†
int lucas(LL a, LL b, int p)
{
    if (a < p && b < p) return C(a, b, p);
    return (LL)C(a % p, b % p, p) * lucas(a / p, b / p, p) % p;
}
```

### ç»„åˆæ•° 4

è¾“å…¥ $a$ï¼Œ$b$ï¼Œæ±‚ $C_a^b$ çš„å€¼ã€‚

æ•°æ®èŒƒå›´ï¼š$1 <= b <= a <= 5000$

ä»å®šä¹‰å‡ºå‘ï¼Œä½¿ç”¨é«˜ç²¾åº¦è®¡ç®— $C_a^b = \frac{a*(a-1)*\cdots*(a-b+1)}{b*(b-1)*\cdots*1}$ï¼Œåªéœ€è¦é«˜ç²¾åº¦ä¹˜æ³•å’Œé™¤æ³•ï¼Œä½†æ˜¯è¿™æ ·æ¯”è¾ƒéš¾å†™ã€‚ä¸€èˆ¬é‡‡ç”¨å¦‚ä¸‹æ–¹æ³•ï¼š

- åˆ†è§£è´¨å› æ•°ï¼š$C_a^b = \frac{a!}{(a-b)!b!} = p_1^{\alpha_1} * p_2^{\alpha_2} * \cdots * p_k^{\alpha_k}$
    - é˜¶ä¹˜åˆ†è§£è´¨å› æ•°ï¼Œ$n!$ ä¸­ p çš„ä¸ªæ•°ï¼š$\lfloor \frac{n}{p} \rfloor + \lfloor \frac{n}{p^2} \rfloor + \cdots + \lfloor \frac{n}{p^k} \rfloor$ï¼Œæ³¨æ„ç†è§£è¿™ä¸ªå…¬å¼ ğŸ˜Š
- ç„¶åä½¿ç”¨é«˜ç²¾åº¦ä¹˜æ³•è®¡ç®—ä¸Šå¼

è®¡ç®—æ­¥éª¤ï¼š

- ç­›è´¨æ•°
- æ±‚æ¯ä¸ªè´¨æ•°çš„ä¸ªæ•°
- ç”¨é«˜ç²¾åº¦æŠŠè´¨å› å­ä¹˜åˆ°ä¸€èµ·

```C++
const int N = 5010;
int primes[N], cnt;
int sum[N];
int st[N];

int get_primes(int n) {
    // çº¿æ€§ç­›ç´ æ•°
    for (int i = 2; i <= n; i++) {
        if (!st[i]) primes[cnt++] = i;
        for (int j = 0; primes[j] <= n / i; j++) {
            st[i * primes[j]] = true;
            if (i % primes[j] == 0) break;
        }
    }
}

// è®¡ç®— n! ä¸­çš„ p çš„ä¸ªæ•°
int get(int n, int p) {
    int res = 0;
    while (n) {
        res += n / p;
        n /= p;
    }
    return res;
} 

vector<int> mul(vector<int> a, int b) {
    vector<int> c;
    int t = 0;
    for (int i = 0; i < a.size(); i++) {
        t += a[i] * b;
        c.push_back(t % 10);
        t /= 10; 
    }

    while (t) {
        c.push_back(t % 10);
        t /= 10;
    }

    return c;
}

int main() {
    int a, b;
    cin >> a >> b;

    // ç­›è´¨æ•°
    get_primes(a);  // å› ä¸º a > b æ‰€ä»¥ç­› a

    // è®¡ç®—æ¯ä¸€ä¸ªè´¨æ•°çš„æ¬¡æ•°
    for (int i = 0; i < cnt; i++) {
        int p = primes[i];
        sum[i] = get(a, p) - get(b, p) - get(a-b, p);
        
        // cout << primes[i] << " " << sum[i] << endl;
    }

    // ä½¿ç”¨é«˜ç²¾åº¦ä¹˜æ³•è®¡ç®—æœ€ç»ˆç»“æœ
    vector<int> res;
    res.push_back(1);
    for (int i = 0; i < cnt; i++) {
        for (int j = 0; j < sum[i]; j++) {
            res = mul(res, primes[i]);
            
        }
    }

    // è¾“å‡ºç­”æ¡ˆ
    for (int i = res.size() - 1; i >= 0; i--) cout << res[i];
    cout << endl;

    return 0;
}
```

### å¡ç‰¹å…°æ•°

[OI WiKi å¡ç‰¹å…°æ•°å®šä¹‰](https://oi-wiki.org/math/combinatorics/catalan/)

é¢˜ç›®ï¼šç»™å®š $n$ ä¸ª 0 å’Œ $n$ ä¸ª 1ï¼Œå®ƒä»¬å°†æŒ‰ç…§æŸç§é¡ºåºæ’æˆé•¿åº¦ä¸º $2n$ çš„åºåˆ—ï¼Œæ±‚å®ƒä»¬èƒ½æ’åˆ—æˆçš„æ‰€æœ‰åºåˆ—ä¸­ï¼Œèƒ½å¤Ÿæ»¡è¶³ä»»æ„å‰ç¼€åºåˆ—ä¸­ 0 çš„ä¸ªæ•°éƒ½ä¸å°‘äº 1 çš„ä¸ªæ•°çš„åºåˆ—æœ‰å¤šå°‘ä¸ªã€‚è¾“å‡ºçš„ç­”æ¡ˆå¯¹ $10^9+7$ å–æ¨¡ã€‚ç±»ä¼¼é—®é¢˜ï¼š[130. ç«è½¦è¿›å‡ºæ ˆé—®é¢˜](https://www.acwing.com/problem/content/132/)

ç®—æ³•æ€è·¯ï¼š

å°†è¿™ä¸ªæ±‚æ–¹æ¡ˆæ•°çš„é—®é¢˜è½¬åŒ–åˆ°äºŒç»´åæ ‡ç³»ä¸Šï¼šä» (0, 0) å‡ºå‘åˆ° (n, n) è¿™ä¸ªç‚¹ä¸€å…±æœ‰å¤šå°‘è·¯å¾„æ•°ï¼Œå¹¶ä¸”è¦æ±‚è·¯å¾„ä¸Šçš„ç‚¹ (x, y) æ»¡è¶³ x >= yã€‚

å¯¹åº”åˆ°åæ ‡ç³»ä¸Šï¼Œå°±æ˜¯ç»è¿‡çš„ç‚¹å¿…é¡»åœ¨ (0, 0) ä¸ (n, n) çš„è¿çº¿ï¼ˆç»¿çº¿ï¼‰ä¸Šæˆ–è€…ä¸‹æ–¹ã€‚æœ€ç»ˆç­”æ¡ˆå¯ä»¥ç”¨**æ€»çš„è·¯å¾„æ•°å‡å»è¶Šè¿‡ç»¿çº¿çš„è·¯å¾„æ•°**ï¼Œæ€»çš„ä¸ªæ•°æ˜¯ï¼š$C_{2n}^n$ã€‚

å¦å¤–ï¼Œæˆ‘ä»¬ç”»ä¸€æ¡çº¢çº¿ï¼ˆç»¿çº¿å‘ y è½´æ­£æ–¹å‘å¹³ç§»ä¸€ä¸ªå•ä½ï¼‰ï¼Œå¹¶æŠŠè¶Šè¿‡ç»¿çº¿çš„è·¯å¾„**ä»è¶Šè¿‡çš„ç‚¹å¼€å§‹**åšçº¢çº¿çš„è½´å¯¹ç§°å¤„ç†ï¼Œè¿™æ ·è·¯å¾„çš„ç»ˆç‚¹å°±å˜æˆäº† (n-1, n+1)ï¼Œè€Œä¸”è¿™æ ·çš„å¤„ç†åå¾—åˆ°çš„æ–°è·¯å¾„å’ŒåŸè·¯å¾„æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚

æ‰€ä»¥ä» (0, 0) å‡ºå‘åˆ° (n-1, n+1) çš„è·¯å¾„æ•°å°±æ˜¯ ä» (0, 0) å‡ºå‘åˆ° (n, n) å¹¶ä¸”è¶Šè¿‡ç»¿çº¿çš„è·¯å¾„æ•°ï¼š$C_{2n}^{n-1}$

æ•…ï¼Œæœ€ç»ˆç­”æ¡ˆï¼š$H_n = C_{2n}^{n} - C_{2n}^{n-1}$

**Catalan** æ•° $H_n$ çš„å…¬å¼:

$$
H_n = C_{2n}^{n} - C_{2n}^{n-1} 
= \frac{C_{2n}^{n}}{n+1} 
= \frac{1}{n+1} * \frac{2n*(2n-1)*\cdots*(n+1)}{n*(n-1)*\cdots*1}
= \frac{H_{n-1}(4n-2)}{n+1}
$$

```C++
const int mod = 1e9+7;
int qmi(int a, int k, int p) {
    int res = 1;
    while (k) {
        if (k & 1) res = (LL) res * a % p;
        a = (LL) a * a % p;
        k >>= 1;
    }
    return res;
}

int main() {
    int n;
    cin >> n;
    
    // ç®—ç»„åˆæ•°
    int res = 1;
    for (int i = n, j = 2 * n; i > 0; i--, j--) {
        // åˆ†å­
        res = (LL) res * j % mod;
        // åˆ†æ¯
        res = (LL) res * qmi(i, mod - 2, mod) % mod;
    }
    
    // n+1 é€†å…ƒ
    res = (LL) res * qmi(n + 1, mod - 2, mod) % mod;
    
    cout << res << endl;
    return 0;
}
```

## å®¹æ–¥åŸç†

m ä¸ªé›†åˆç»„æˆçš„äº¤é›†ä¸­å…ƒç´ çš„ä¸ªæ•°ï¼š

$$
S = S_1\cup\cdots\cup S_m =\sum_{i}S_i - \sum_{i, j}S_i\cap S_j + \sum_{i, j, k}S_i\cap S_j\cap S_k + \cdots + (-1)^{m-1}S_1\cap\cdots\cap S_m
$$

å®¹æ–¥åŸç†çš„æ—¶é—´å¤æ‚åº¦ä¸º $2^m$ï¼Œå…¶ä¸­ m æ˜¯é›†åˆçš„ä¸ªæ•°ã€‚ä¸€èˆ¬åœ°ï¼Œå¦‚æœé¢˜ç›®ä¸­ m çš„èŒƒå›´ä¸å¤§ï¼Œå¯ä»¥å€ŸåŠ©ä½è¿ç®—ä¼˜åŒ–ç®—æ³•ï¼Œå®¹æ–¥åŸç†å’Œä½è¿ç®—åŸºæœ¬ç»‘å®š

```C++
using LL = long long;
const int M = 20;
int p[M];

int main() {
    int n, m;
    cin >> n >> m;

    for (int i = 0; i < m; i++) cin >> p[i];

    int res = 0;
    // å…ˆæšä¸¾çŠ¶æ€
    for (int i = 1; i < 1 << m; i++) {
        int t = 1, cnt = 0;
        // æŸ¥çœ‹æ˜¯å“ªäº›é›†åˆ
        for (int j = 0; j < m; j++) {
            if ((i >> j & 1) == 0) {  // == çš„ä¼˜å…ˆçº§æ¯” & é«˜
                continue;
            }
            
            if ((LL) t * p[j] > n) {
                t = -1;
                break;
            }
            
            cnt++;
            t *= p[j];
        }
        if (t != -1) {
            res += (cnt % 2 ? 1 : -1) * n / t;
        }
    }
    // æ—¶é—´å¤æ‚åº¦ç¡®å®æ˜¯ O(2^m*m)

    cout << res << endl;
    return 0;
}
```

## åšå¼ˆè®º

### Nim æ¸¸æˆ

ç»™å®š n å †çŸ³å­ï¼Œä¸¤ä½ç©å®¶è½®æµæ“ä½œï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥ä»ä»»æ„ä¸€å †çŸ³å­ä¸­æ‹¿èµ°ä»»æ„æ•°é‡çš„çŸ³å­ï¼ˆå¯ä»¥æ‹¿å®Œï¼Œä½†ä¸èƒ½ä¸æ‹¿ï¼‰ï¼Œæœ€åæ— æ³•è¿›è¡Œæ“ä½œçš„äººè§†ä¸ºå¤±è´¥ã€‚é—®å¦‚æœä¸¤äººéƒ½é‡‡ç”¨æœ€ä¼˜ç­–ç•¥ï¼Œå…ˆæ‰‹æ˜¯å¦å¿…èƒœã€‚

åˆ†æï¼šå½“å‰ n å †çŸ³å­å¯ä»¥åˆ†æˆ 2 ç§çŠ¶æ€ï¼š**å¿…èƒœçŠ¶æ€**å’Œ**å¿…è´¥çŠ¶æ€**ï¼Œå¿…èƒœçŠ¶æ€æ˜¯æŒ‡ï¼šä»å½“å‰çŠ¶æ€å‡ºå‘ï¼Œå¯ä»¥æ‹¿æ‰æŸä¸€å †çš„æŸäº›çŸ³å­ï¼Œä½¿å¾—çŠ¶æ€å˜æˆå¿…è´¥çŠ¶æ€ï¼›å¿…è´¥çŠ¶æ€æ˜¯æŒ‡ï¼šä»å½“å‰çŠ¶æ€å‡ºå‘ï¼Œæ— è®ºæ€ä¹ˆæ‹¿çŸ³å­ï¼ŒçŠ¶æ€éƒ½ä¼šå˜æˆå¿…èƒœçŠ¶æ€

å¦‚æœå…ˆæ‰‹æ˜¯å¿…èƒœçŠ¶æ€ï¼Œé‚£ä¹ˆå…ˆæ‰‹å¿…èƒœï¼›å¦åˆ™å…ˆæ‰‹å¿…è´¥

ä»£ç ä¸€åˆ†é’ŸğŸ˜ï¼šå¼‚æˆ–å®šä¹‰**å¿…èƒœçŠ¶æ€**å’Œ**å¿…è´¥çŠ¶æ€**ï¼šæ‰€æœ‰çŸ³å­å †ä¸ªæ•°**å¼‚æˆ–å’Œä¸ä¸º 0** è¡¨ç¤º**å…ˆæ‰‹å¿…èƒœ**çŠ¶æ€ï¼Œå¦åˆ™å…ˆæ‰‹å¿…è´¥

### å°é˜¶-Nimæ¸¸æˆ

å°é˜¶-Nim æ¸¸æˆåªçœ‹å¥‡æ•°å°é˜¶æ—¶ï¼Œå°±æ˜¯åŸæœ¬çš„ Nim æ¸¸æˆ

### é›†åˆ-Nimæ¸¸æˆ

ç»™å®š n å †çŸ³å­ä»¥åŠä¸€ä¸ªç”± k ä¸ªä¸åŒæ­£æ•´æ•°æ„æˆçš„æ•°å­—é›†åˆ S

ç°åœ¨æœ‰ä¸¤ä½ç©å®¶è½®æµæ“ä½œï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥ä»ä»»æ„ä¸€å †çŸ³å­ä¸­æ‹¿å–çŸ³å­ï¼Œæ¯æ¬¡æ‹¿å–çš„çŸ³å­æ•°é‡å¿…é¡»åŒ…å«äºé›†åˆ S ï¼Œæœ€åæ— æ³•è¿›è¡Œæ“ä½œçš„äººè§†ä¸ºå¤±è´¥

é—®å¦‚æœä¸¤äººéƒ½é‡‡ç”¨æœ€ä¼˜ç­–ç•¥ï¼Œå…ˆæ‰‹æ˜¯å¦å¿…èƒœ

è®¡ç®—æ¯ä¸€å †çŸ³å­åˆå§‹å€¼çš„ $SG(x_0)$ å€¼ã€‚å¦‚æœæ‰€æœ‰çŸ³å­å †çš„ SG å€¼å¼‚æˆ–ç»“æœç­‰äº 0ï¼Œå°±æ˜¯å¿…è´¥çŠ¶æ€ï¼›å¦‚æœç­‰äº 1ï¼Œå°±æ˜¯å¿…èƒœçŠ¶æ€ã€‚ä»£ç å®ç°æ—¶ä½¿ç”¨ è®°æœ è®¡ç®—çŸ³å­å †åˆå§‹å€¼çš„ SG å€¼

### æ‹†åˆ†-Nimæ¸¸æˆ

ç»™å®š n å †çŸ³å­ï¼Œä¸¤ä½ç©å®¶è½®æµæ“ä½œï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥å–èµ°å…¶ä¸­çš„ä¸€å †çŸ³å­ï¼Œç„¶åæ”¾å…¥ä¸¤å †è§„æ¨¡æ›´å°çš„çŸ³å­ï¼ˆæ–°å †è§„æ¨¡å¯ä»¥ä¸º 0 ï¼Œä¸”ä¸¤ä¸ªæ–°å †çš„çŸ³å­æ€»æ•°å¯ä»¥å¤§äºå–èµ°çš„é‚£å †çŸ³å­æ•°ï¼‰ï¼Œæœ€åæ— æ³•è¿›è¡Œæ“ä½œçš„äººè§†ä¸ºå¤±è´¥ã€‚

é—®å¦‚æœä¸¤äººéƒ½é‡‡ç”¨æœ€ä¼˜ç­–ç•¥ï¼Œå…ˆæ‰‹æ˜¯å¦å¿…èƒœã€‚

ä¸åŒæ¸¸æˆçš„ sg è®¡ç®—æ–¹å¼ä¸åŒï¼Œè¿™é‡Œæ˜¯æ‹†åˆ†çŸ³å¤´å †ï¼Œç›¸å½“äºä¸€å †å¤§çŸ³å¤´åˆ†æˆä¸¤å †å°çŸ³å¤´ã€‚å¦å¤–æ ¹æ® sg å®šç†ï¼Œè¿™ä¸¤é˜ŸçŸ³å¤´çš„ sg å€¼æ˜¯å„è‡ª sg å€¼çš„å¼‚æˆ–ï¼Œæœ€ç»ˆ sg å€¼å°±æ˜¯ mex æ‰€æœ‰æ‹†åˆ†çš„ sg å€¼






