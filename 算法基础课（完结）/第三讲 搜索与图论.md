#! https://zhuanlan.zhihu.com/p/655902227
# æœç´¢ä¸å›¾è®º

## æ·±åº¦ä¼˜å…ˆæœç´¢ DFS

> ä¿—ç§° **çˆ†æœ**ï¼Œæšä¸¾æ¯ä¸€ç§æƒ…å†µ

[842. æ’åˆ—æ•°å­—](https://www.acwing.com/problem/content/844/) ä½¿ç”¨**ä½è¿ç®—**ä¼˜åŒ–çš„å†™æ³•ï¼Œè¿™é¢˜å‡†ç¡®è®²æ˜¯**å›æº¯**

```C++
int n;  // æ•°æ®èŒƒå›´ n <= 7
vector<int> path;  // æ•°ç»„ä¹Ÿå¯ä»¥

void dfs(int i, int mask) {
    if (i == n) {  // èµ°åˆ°å¤´ä¹‹å æ‰“å°ä¿å­˜çš„æ•°å­—
        for (auto num: path) cout << num << " ";
        cout << endl;
        return;
    }
    // è¿™ä¸ª dfs é¡ºåºä¿è¯äº†æœ‰åº
    for (int j = 0; j < n; j++) {
        if ((mask >> j & 1) == 0) {
            path.push_back(j+1);
            dfs(i+1, mask | (1 << j));
            path.pop_back();  // æ¢å¤ç°åœº
        }
    }
}

int main() {
    cin >> n;
    dfs(0, 0);
    return 0;
}
```

[843. n-çš‡åé—®é¢˜](https://www.acwing.com/problem/content/845/) **DFS ç»å…¸é—®é¢˜**

æ³¨æ„ç»´æŠ¤ **åˆ—ã€å·¦ä¸Šæ–¹ã€å³ä¸Šæ–¹** çš„æ”¾ç½®æƒ…å†µçš„æ–¹æ³•ï¼š

- **å·¦ä¸Šæ–¹** çš„ä½ç½® `x-y` æ˜¯å®šå€¼
- **å³ä¸Šæ–¹** çš„ä½ç½® `x+y` æ˜¯å®šå€¼

**æ—¶é—´å¤æ‚åº¦åˆ†æ**ï¼š
ä¸€å…±æœ‰ `n!` ä¸ªæœç´¢æ ‘å¶å­ï¼Œè€Œä¸”éœ€è¦ `n^2` çš„æ—¶é—´æ‰¾åˆ°æ¯ä¸ªå¶å­èŠ‚ç‚¹ï¼Œæ€»çš„æ—¶é—´å¤æ‚åº¦å°±æ˜¯ `O(n^2*n!)`ï¼Œä½†æ˜¯ç”±äºå‰ªæçš„å­˜åœ¨ï¼Œä¸ä¼šéå†æ‰€æœ‰çš„å¶å­èŠ‚ç‚¹ï¼Œæ—¶é—´å¤æ‚åº¦è¾¾ä¸åˆ° `O(n^2*n!)`

```C++
const int N = 10;
int n;
// ç»´æŠ¤ åˆ—ã€å·¦ä¸Šæ–¹ã€å³ä¸Šæ–¹ çš„æ”¾ç½®æƒ…å†µ
bool c[N], l[2*N], r[2*N]; // ç”±äº n <= 9 å¯ä»¥ä½¿ç”¨ä½è¿ç®—ä¼˜åŒ–

// æšä¸¾æ¯ä¸€è¡Œé€‰å“ªä¸€åˆ—
vector<string> path;
void dfs(int i) {
    if (i == n) { // æšä¸¾ç»“æŸ æ‰“å°æ”¾ç½®æƒ…å†µ
        for (auto& r: path) cout << r << endl;
        cout << endl;
        return;
    }
    for (int j = 0; j < n; j++) {
        // è¿™é‡Œæ˜¯å‰ªæ ä¸ç¬¦åˆè¦æ±‚çš„è¯·å†µä¸ä¼šé€’å½’åˆ°
        if (!c[j] && !l[i-j+n] && !r[i+j]) {
            c[j] = l[i-j+n] = r[i+j] = true;
            path.push_back(string(j, '.') + 'Q' + string(n-1-j, '.'));
            dfs(i+1);
            // æ¢å¤ç°åœº
            path.pop_back();
            c[j] = l[i-j+n] = r[i+j] = false;
        }
    }
}

int main() {
    cin >> n;
    dfs(0);
    return 0;
}
```

## å®½åº¦ä¼˜å…ˆæœç´¢ BFS

> å®½æœå¯ä»¥æ‰¾åˆ° **æœ€çŸ­è·¯**ï¼šç¬¬ä¸€æ¬¡é‡åˆ°æŸä¸ªä½ç½®æ—¶çš„è·ç¦»å°±æ˜¯æœ€çŸ­è·¯ï¼Œ**å‰ææ˜¯è·¯å¾„æƒé‡éƒ½ä¸€æ ·**

[844. èµ°è¿·å®«](https://www.acwing.com/problem/content/846/)  **BFS æœ€çŸ­è·¯æ¨¡æ¿**

- è¿™ä¸ªé¢˜ç›®ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ª**æ•°ç»„è®°å½•æœ€çŸ­è·ç¦»**

```C++
const int N = 100;
const int dx[4] = {-1, 0, 1, 0};
const int dy[4] = {0, 1, 0, -1};

int n, m, a[N][N];
int main() {
    cin >> n >> m;
    for (int i = 0; i < n; i++) {
        for (int j = 0; j < m; j++) {
            cin >> a[i][j];
        }
    }
    
    queue<pair<int, int>> q;
    q.push({0, 0});
    a[0][0] = 1;
    
    int cnt = 0;
    while (!q.empty()) {
        int si = q.size();
        for (int i = 0; i < si; i++) {
            auto [x, y] = q.front();
            q.pop();
            // ç¬¬ä¸€æ¬¡é‡åˆ° (n-1, m-1)
            if (x == n-1 && y == m-1) {
                cout << cnt;  // æœ€çŸ­è·¯
                return 0;
            }
            for (int j = 0; j < 4; j++) {
                int nx = x + dx[j], ny = y + dy[j];
                if (0 <= nx && 0 <= ny && nx < n && ny < m && !a[nx][ny]) {
                    a[nx][ny] = 1;
                    q.push({nx, ny});
                }
            }
        }
        cnt++;
    }
    return 0;
}
```

[845. å…«æ•°ç ](https://www.acwing.com/problem/content/847/)

æŠŠæ£‹ç›˜çŠ¶æ€çœ‹ä½œæ˜¯å›¾ä¸­çš„ä¸€ä¸ªç‚¹ï¼Œåˆ™æœ‰ **èµ·ç‚¹çŠ¶æ€** å’Œ **ç»ˆç‚¹çŠ¶æ€**ï¼Œç›¸è¿çš„ç‚¹ä¹‹é—´æƒé‡ä¸º 1ï¼Œç›®æ ‡å°±æ˜¯æ‰¾åˆ° èµ·ç‚¹çŠ¶æ€ å’Œ ç»ˆç‚¹çŠ¶æ€ çš„æœ€çŸ­çš„è·¯å¾„

éš¾ç‚¹åœ¨äºï¼šå¦‚ä½•è®°å½•çŠ¶æ€ --> ä½¿ç”¨å­—ç¬¦ä¸²è®°å½•çŠ¶æ€ï¼Œä»¥åŠçŠ¶æ€è·ç¦» --> ä½¿ç”¨ stl çš„ unordered_map å­˜å‚¨

çŠ¶æ€è½¬ç§»ï¼šæšä¸¾çŠ¶æ€ä¸­ x çš„ä¸Šä¸‹å·¦å³åˆæ³•ä½ç½®ç„¶åäº¤æ¢

```C++
int bfs(string start) {
    string end = "12345678x";  // å¼€å§‹çŠ¶æ€
    queue<string> q;  // é˜Ÿåˆ—
    unordered_map<string, int> d;  // å­˜å‚¨èŠ‚ç‚¹è·ç¦»

    int dx[4] = {-1, 0, 1, 0};
    int dy[4] = {0, 1, 0, -1};

    q.push(start);
    d[start] = 0;

    while (!q.empty()) {
        auto t = q.front();
        q.pop();
        int dis = d[t];
        if (t == end) return dis;

        // çŠ¶æ€è½¬ç§»
        int k = t.find('x');
        int x = k / 3, y = k % 3;
        for (int i = 0; i < 4; i++) {
            int nx = x + dx[i], ny = y + dy[i];
            if (0 <= nx && 0 <= ny && nx < 3 && ny < 3) {
                // äº¤æ¢
                swap(t[k], t[nx * 3 + ny]);
                // å¦‚æœæ–°çŠ¶æ€æ²¡é‡åˆ°è¿‡
                if (!d.count(t)) {
                    d[t] = dis + 1;
                    q.push(t);
                }
                // æ¢å›å»
                swap(t[k], t[nx * 3 + ny]);
            }
        }
    }
    return -1;
}

int main() {
    string start;
    for (int i = 0; i < 9; i++) {
        char ch;
        cin >> ch;
        start += ch;
    }
    cout << bfs(start);
    return 0;
}
```

## æ ‘ä¸å›¾çš„å­˜å‚¨

> **æ ‘ï¼šæ— ç¯è¿é€šå›¾**

å›¾ä¸€èˆ¬æœ‰ä¸¤ç§ï¼š**æœ‰å‘å›¾** å’Œ **æ— å‘å›¾**ï¼Œæ— å‘å›¾æ˜¯ç‰¹æ®Šçš„æœ‰å‘å›¾ï¼šä¸€æ¡æ— å‘è¾¹ç­‰äºä¸¤æ¡æœ‰å‘è¾¹

æœ‰å‘å›¾çš„å­˜å‚¨æ–¹å¼ï¼š

- **é‚»æ¥çŸ©é˜µ**ï¼šé€‚åˆå­˜å‚¨ **ç¨ å¯†å›¾**ï¼Œå°±æ˜¯ä¸€ä¸ªäºŒç»´çŸ©é˜µ `edge[N][N]`

- **é‚»æ¥è¡¨**ï¼šé€‚åˆå­˜å‚¨ **ç¨€ç–å›¾**ï¼Œæœ¬è´¨æ˜¯ `n` ä¸ªå•é“¾è¡¨

**é‚»æ¥è¡¨æ¨¡æ¿**

```C++
// N èŠ‚ç‚¹ä¸ªæ•°  M è¾¹çš„ä¸ªæ•°
int h[N], e[M], ne[M], idx;

// åœ¨ a b ä¹‹é—´å»ºä¸€æ¡æœ‰å‘è¾¹ï¼ša->b
void add(int a, int b) {
    e[idx] = b;
    ne[idx] = h[a];
    h[a] = idx++;
}

// è®°å¾—åˆå§‹åŒ– h æ•°ç»„
memset(h, -1, sizeof h);
```

## æ ‘ä¸å›¾çš„æ·±åº¦ä¼˜å…ˆéå†

**æ·±æœçš„æ¡†æ¶** æ—¶é—´å¤æ‚åº¦ `O(N+M)`ï¼Œéå†äº†**æ‰€æœ‰çš„ç‚¹å’Œè¾¹**

```C++
// éå†èŠ‚ç‚¹ a
void dfs(int a) {
    st[a] = true;  // æ ‡è®°
    // éå†å­©å­
    for (int i = h[a]; ~i; i = ne[i]) {
        int b = e[i];
        if (!st[b]) dfs(b);
    }
}
```

[846. æ ‘çš„é‡å¿ƒ](https://www.acwing.com/problem/content/description/848/)  æ³¨æ„**æ— å‘è¾¹å»ºæ ‘**æ—¶ï¼Œ**è¾¹æ•°ç›®æ˜¯ç‚¹æ•°ç›®çš„ä¸¤å€**

```C++
// é‚»æ¥è¡¨å­˜å›¾ï¼ˆé“¾å¼å‰å‘æ˜Ÿï¼‰
// ç”±äºæ˜¯æ— å‘å›¾ è¾¹çš„æ•°ç›®æ˜¯ç‚¹æ•°ç›®çš„ 2 å€ å¼€ 2 * N
int n;
const int N = 1e5 + 7, M = 2 * N;
int h[N], e[M], ne[M], idx;
bool vis[N]; // è¡¨ç¤ºè¯¥ç‚¹æ˜¯å¦é‡åˆ°è¿‡
int ans = N;  // ç­”æ¡ˆå¿…é¡»å¾—æ˜¯å…¨å±€çš„

// å»ºç«‹ä¸€æ¡ a -> b çš„è¾¹
void add(int a, int b) {
    e[idx] = b;  // å½“å‰èŠ‚ç‚¹æŒ‡å‘ b
    ne[idx] = h[a];  // æŠŠå½“å‰èŠ‚ç‚¹æ”¾åˆ° a çš„é“¾å­ä¸Š ä¸” idx++
    h[a] = idx++;
}

// æ·±åº¦ä¼˜å…ˆéå†
// è¿”å›ä»¥ u ä¸ºæ ¹çš„å­æ ‘ä¸­ç‚¹çš„æ•°é‡
int dfs(int u) {
    vis[u] = true;
    int cnt = 0, mx= 0;
    for (int i = h[u]; ~i; i = ne[i]) {
        int j = e[i];
        if (!vis[j]) {
            int t = dfs(j);
            mx = max(mx, t);
            cnt += t;
        }
    }
    // ç”¨å­æ ‘èŠ‚ç‚¹æ•°é‡çš„æœ€å¤§å€¼æ›´æ–°ç­”æ¡ˆ
    mx = max(mx, n - 1 - cnt);
    ans = min(ans, mx);
    return cnt + 1; // è¿”å›è¿™æ£µæ ‘çš„èŠ‚ç‚¹ä¸ªæ•°
}

int main() {
    // å›¾åˆå§‹åŒ–
    memset(h, -1, sizeof h);
    // å»ºå›¾
    cin >> n;
    for (int i = 1; i < n; i++) {
        int x, y;
        cin >> x >> y;
        add(x, y);
        add(y, x);
    }
    
    // æ·±æœ
    dfs(1);
    cout << ans << endl;
    return 0;
}
```

## æ ‘ä¸å›¾çš„å®½åº¦ä¼˜å…ˆéå†

**å®½æœçš„æ¡†æ¶** æ—¶é—´å¤æ‚åº¦ä¹Ÿæ˜¯ `O(N+M)`

[847. å›¾ä¸­ç‚¹çš„å±‚æ¬¡](https://www.acwing.com/problem/content/849/) æ¯”è¾ƒè£¸çš„ä¸€é“é¢˜ç›®ï¼Œå› ä¸ºè·¯å¾„é•¿åº¦éƒ½æ˜¯ 1ï¼Œå¯ä»¥ä½¿ç”¨å®½æœæ±‚æœ€çŸ­è·¯

```C++
int n, m, d[N];  // è·ç¦»æ•°ç»„ä¹Ÿç”¨æ¥è¡¨ç¤ºæ˜¯å¦éå†è¿‡
int h[N], e[N], ne[N], idx; // è¿™é‡Œæ˜¯ä¸€ä¸ªæœ‰å‘å›¾ ä¸ç”¨ 2N

void add(int a, int b) {
    e[idx] = b;
    ne[idx] = h[a];
    h[a] = idx++;
}

// ä» u åˆ°ç»ˆç‚¹ n çš„è·ç¦»
void bfs(int u) {
    // åˆå§‹åŒ– è·ç¦»æ•°ç»„ å…¶å® 0x3f ä¹Ÿè¡Œ 
    // æ¯•ç«Ÿåªæœ‰ç¬¬ä¸€æ¬¡éå†åˆ°æ‰æ˜¯æœ€çŸ­è·¯
    memset(d, -1, sizeof d);
    queue<int> q;
    q.push(u);
    d[u] = 0;
    while (!q.empty()) {
        int x = q.front();
        q.pop();
        for (int i = h[x]; ~i; i = ne[i]) {
            int j = e[i];
            if (d[j] == -1) {
                q.push(j);
                d[j] = d[x] + 1;
            }
        }
    }
}
```

## æ‹“æ‰‘æ’åº

> æ±‚**æœ‰å‘å›¾**çš„**æ‹“æ‰‘åº**ï¼Œæœ¬è´¨ä¸Šæ˜¯**å®½æœ**çš„ä¸€ä¸ªåº”ç”¨

**å®šä¹‰**ï¼šè‹¥ä¸€ä¸ªç”±å›¾ä¸­æ‰€æœ‰ç‚¹æ„æˆçš„**åºåˆ— A** æ»¡è¶³ï¼šå¯¹äºå›¾ä¸­çš„**æ¯æ¡è¾¹ (x,y)ï¼Œx åœ¨ A ä¸­éƒ½å‡ºç°åœ¨ y ä¹‹å‰**ï¼Œåˆ™ç§° A æ˜¯è¯¥å›¾çš„ä¸€ä¸ªæ‹“æ‰‘åºåˆ—ã€‚

**æ€§è´¨ï¼š**

* åªæœ‰ **æœ‰å‘æ— ç¯å›¾ï¼ˆDAGï¼‰** æ‰èƒ½è¿›è¡Œæ‹“æ‰‘æ’åº
* å¯ä»¥ç”¨æ¥æ‰¾ **æ‹“æ‰‘åº** æˆ–è€… **åˆ¤æ–­æœ‰å‘å›¾æ˜¯å¦æœ‰ç¯**
* æ³¨æ„æ‹“æ‰‘åºå¹¶ **ä¸å”¯ä¸€**
* å¦‚æœéœ€è¦ä¿å­˜æ‹“æ‰‘åºï¼Œä½¿ç”¨ **æ¨¡æ‹Ÿé˜Ÿåˆ—** æ›´æ–¹ä¾¿ğŸ˜

**æ­¥éª¤ï¼š**

1. å…¥é˜Ÿ **å…¥åº¦ä¸ºé›¶çš„ç‚¹**
2. ä½¿ç”¨å®½æœçš„æ¡†æ¶ **æ¯æ¬¡ pop å‡ºé˜Ÿå¤´**ï¼Œå¹¶ **æ›´æ–°å…¶ä½™ç‚¹çš„å…¥åº¦**
3. å¦‚æœé‡åˆ° **æ–°çš„å…¥åº¦ä¸ºé›¶çš„ç‚¹**ï¼ŒæŠŠå®ƒ **å…¥é˜Ÿ**
4. ç›´åˆ°é˜Ÿåˆ—ä¸ºç©º


[848. æœ‰å‘å›¾çš„æ‹“æ‰‘åºåˆ—](https://www.acwing.com/problem/content/850/) 

```C++
const int N = 1e5 + 7;
int n, m; // é‚»æ¥è¡¨
int h[N], e[N], ne[N], idx; // è®°å¾—åˆå§‹åŒ– h ä¸º -1
int q[N], hh, tt = -1; // æ¨¡æ‹Ÿé˜Ÿåˆ—
int inDegree[N]; // å…¥åº¦ç»„æ•°

void add(int a, int b) {
    e[idx] = b;
    ne[idx] = h[a];
    h[a] = idx++;
}

bool topsort() {
    // å…¥åº¦ä¸ºé›¶çš„ç‚¹å…¥é˜Ÿ
    for (int i = 1; i <= n; i++) {
        if (inDegree[i] == 0) q[++tt] = i;
    }
    // å½“é˜Ÿåˆ—ä¸ç©º
    while (hh <= tt) {
        int u = q[hh];
        hh++;
        for (int i = h[u]; ~i; i = ne[i]) {
            int j = e[i];
            inDegree[j]--;
            if (inDegree[j]  == 0) q[++tt] = j;
        }
    }
    return hh == n; // tt == n-1
}
```

## æœ€çŸ­è·¯é—®é¢˜åˆ†ç±»

æœ€çŸ­è·¯é—®é¢˜ **ä¸åŒºåˆ†æœ‰å‘è¾¹å’Œæ— å‘è¾¹**

### å•æºæœ€çŸ­è·¯

**åˆ†ç±»**

- æ‰€æœ‰è¾¹æƒéƒ½æ˜¯æ­£æ•°
    * **æœ´ç´  Dijkstra ç®—æ³•**ï¼Œæ—¶é—´å¤æ‚åº¦ O(n^2)ï¼Œé€‚åˆç¨ å¯†å›¾
    * **å †ä¼˜åŒ– Dijkstra ç®—æ³•**ï¼Œæ—¶é—´å¤æ‚åº¦ O(mlog(n))ï¼Œé€‚åˆç¨€ç–å›¾

- å­˜åœ¨è´Ÿæƒè¾¹
    * **Bellman-Ford**ï¼Œæ—¶é—´å¤æ‚åº¦ O(nm)
    * **SPFA**ï¼Œå¹³å‡æ—¶é—´å¤æ‚åº¦ O(m)ï¼Œæœ€åæ—¶é—´å¤æ‚åº¦ O(mn)

### å¤šæºæ±‡æœ€çŸ­è·¯

**Floyd ç®—æ³•**ï¼Œæ—¶é—´å¤æ‚åº¦ O(n^3)     

## æœ´ç´  Dijkstra ç®—æ³•

æ±‚ä» **èŠ‚ç‚¹ 1** å‡ºå‘åˆ° **å…¶ä½™å„ç‚¹** çš„æœ€çŸ­è·¯

**åŸºæœ¬æ€è·¯**

1. åˆå§‹åŒ–è·ç¦» `d[1] = 0`, `d[i] = +inf`
2. éå† n æ¬¡ ï¼ˆæ¯•ç«Ÿåªæœ‰ n ä¸ªç‚¹ï¼‰ã€‚ç»´æŠ¤ **é›†åˆ S**ï¼šå½“å‰å·²ç»ç¡®å®šæœ€çŸ­è·¯ï¼ˆè·ç¦»ï¼‰çš„ç‚¹ã€‚
3. æ‰¾åˆ° **S çš„è¡¥é›†ä¸­çš„è·ç¦»èŠ‚ç‚¹ 1 æœ€è¿‘çš„ç‚¹** æŠŠè¯¥ç‚¹æ”¾åˆ° **S** ä¸­ï¼ˆåŸºäº**è´ªå¿ƒ**çš„æ€æƒ³ï¼‰
4. ç„¶å**æ›´æ–° S çš„è¡¥é›†ä¸­å…¶ä½™ç‚¹çš„æœ€çŸ­è·¯**
* é‡å¤ 1 2 3 ç›´åˆ°éå†ç»“æŸ

æ—¶é—´å¤æ‚åº¦ `O(n^2)`ï¼šä¸€ä¸ª n ç”¨äºéå† n æ¬¡ï¼Œå¦ä¸€ä¸ª n ç”¨äºæ‰¾åˆ°æœ€å°å€¼

æ³¨æ„ï¼š
* Dijkstra ä¸»è¦æ€æƒ³æ˜¯ **è´ªå¿ƒ**
* Dijkstra è¦æ±‚ **ä¸èƒ½å­˜åœ¨è´Ÿæƒè¾¹**
* æœ€çŸ­è·¯é—®é¢˜ **ä¸åŒºåˆ† æœ‰å‘è¾¹ è¿˜æ˜¯ æ— å‘è¾¹**ã€‚æ— å‘è¾¹å½“ä½œä¸¤æ¡æœ‰å‘è¾¹


```C++
const int N = 507;
int n, m, g[N][N];  // è¿™é‡Œä½¿ç”¨é‚»æ¥çŸ©é˜µå­˜å›¾
int d[N];  // å­˜æœ€çŸ­è·¯
bool st[N];  // è®°å½•æ˜¯å¦å·²ç»æ‰¾åˆ°æœ€çŸ­è·¯

int Dijkstra() {
    // åˆå§‹åŒ–è·ç¦»
    memset(d, 0x3f, sizeof d);
    d[1] = 0;

    // éå† n-1 æ¬¡å°±è¡Œ
    for (int i = 1; i < n; i++) {
        // æ‰¾åˆ°å½“å‰æœªç¡®å®šæœ€çŸ­è·¯ç‚¹ä¸­æœ€å°çš„ç‚¹
        int t = -1;
        for (int j = 1; j <= n; j++) {
            // ä¿è¯æ¯æ‰¾åˆ°è¿‡æœ€å°å€¼
            if (!st[j] && (t == -1 || d[t] > d[j])) {
                t = j;
            }
        }
        // ç”¨æ‰¾åˆ°çš„ç‚¹æ›´æ–°å‰©ä½™ç‚¹çš„æœ€çŸ­è·¯
        // æ³¨æ„ è‡ªç¯çš„æƒé‡å…¨æ˜¯æ­£å€¼ æ‰€ä»¥ä¸ä¼šé€ æˆå½±å“
        st[t] = true;  // åŠ å…¥é›†åˆ S
        for (int j = 1; j <= n; j++) {
            d[j] = min(d[j], d[t] + g[t][j]);
        }
    }
    if (d[n] == 0x3f3f3f3f) return -1;
    return d[n];
}

int main() {
    // åˆå§‹åŒ–
    memset(g, 0x3f, sizeof g);

    // å»ºå›¾
    cin >> n >> m;
    for (int i = 0; i < m; i++) {
        int a, b, c;
        cin >> a >> b >> c;
        g[a][b] = min(g[a][b], c);
    }

    // æœ´ç´  Dijkstra
    int ans = Dijkstra();
    cout << ans << endl;

    return 0;
}
```

## å †ä¼˜åŒ– Dijkstra ç®—æ³•

å¦‚æœè‡ªå·±**æ‰‹åŠ¨å®ç°å †**ï¼Œä¿è¯å †ä¸­åªå­˜å‚¨ n ä¸ªç‚¹ï¼Œ**æ—¶é—´å¤æ‚åº¦æ˜¯ O(mlogn)**ï¼›å¦‚æœä½¿ç”¨ **STL ä¼˜å…ˆé˜Ÿåˆ—**ï¼Œå †ä¸­å­˜çš„ç‚¹å¯èƒ½ä¸æ­¢ n ä¸ªï¼ˆæœ€å¤šæ˜¯ mï¼‰ï¼Œ**æ—¶é—´å¤æ‚åº¦** æ˜¯ `O(mlogm) = O(mlog(2*n)) = O(mlogn)`

**æ³¨æ„**
- ä½¿ç”¨ `st[u] = true; if (!st[j] && dist[j] > d + w[i])` æ¥å»é™¤é‡å¤æ“ä½œä¼šè¶…æ—¶ï¼Œå› ä¸ºè¿™ç§å»é‡æ–¹æ³•ä¸å…¨é¢ï¼Œæ— æ³•åº”å¯¹è¿™ç§æƒ…å†µï¼šé˜Ÿåˆ—ä¸­æœ‰å¾ˆå¤šä¸ª `j`ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦æŠŠè¿™äº› j çš„å­©å­éƒ½éå†ä¸€è¾¹ã€‚æ‰€ä»¥è¿˜æ˜¯æ¯æ¬¡ä»é˜Ÿåˆ—å–å‡ºå…ƒç´ å¹¶å»é‡å¥½ä¸€äº›ã€‚

```C++
using PII = pair<int, int>;
const int N = 2e5+7;

int n, m, dist[N];
bool st[N];
// é‚»æ¥è¡¨å­˜ç¨€ç–å›¾
int h[N], w[N], e[N], ne[N], idx;

void add(int a, int b, int c) {
    e[idx] = b;
    w[idx] = c;
    ne[idx] = h[a];
    h[a] = idx++;
}

int Dijkstra() {
    // åˆå§‹åŒ–è·ç¦»æ•°ç»„ åˆå§‹åŒ–ä¸ºæœ€å¤§å€¼
    memset(dist, 0x3f, sizeof dist);

    // ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆå †ï¼‰
    priority_queue<PII, vector<PII>, greater<PII>> q;
    q.push({0, 1});  // æ”¾å…¥èµ·ç‚¹
    dist[1] = 0;

    while (q.size()) {
        auto t = q.top();  // æ‹¿å‡ºé˜Ÿå¤´
        q.pop();

        int d = t.first, u = t.second;
        if (st[u]) continue;  // å¦‚æœå·²ç»ä½¿ç”¨è¯¥ç‚¹æ›´æ–°äº†å…¶ä»–ç‚¹çš„è·ç¦»
        st[u] = true;
        
        // æ›´æ–°å…¶ä½™ç‚¹çš„è·ç¦»
        for (int i = h[u]; ~i; i = ne[i]) {
            int j = e[i];
            if (dist[j] > d + w[i]) {
                dist[j] = d + w[i];  // æ›´æ–°
                q.push({dist[j], j});
            }
        }
    }
    // if (!st[n]) ä¹Ÿè¡Œ
    if (dist[n] == 0x3f3f3f3f) return -1;
    return dist[n];
}

int main() {
    // å»ºå›¾
    cin >> n >> m;
    memset(h, -1, sizeof h);

    for (int i = 0; i < m; i++) {
        int a, b, c;
        cin >> a >> b >> c;
        add(a, b, c);
    }

    // Dijkstra
    cout << Dijkstra() << endl;
    return 0;
}
```

## Bellman-ford ç®—æ³•

**Bellman-ford ç®—æ³•**
* å¤„ç†æœ‰ **è´Ÿæƒè¾¹** çš„å›¾
* æœ‰ä¸€ç§é¢˜å‹åªèƒ½ç”¨ bellman-ford è§£å†³ï¼š**æœ‰è¾¹æ•°é™åˆ¶çš„æœ€çŸ­è·¯**
* å½“å›¾ä¸­å­˜åœ¨ **è´Ÿæƒå›è·¯** æ—¶ï¼Œæ˜¯ **æ²¡æœ‰æœ€çŸ­è·¯**
* Bellman-ford ç®—æ³•ï¼Œå¯ä»¥ **åˆ¤æ–­æ˜¯å¦å­˜åœ¨è´Ÿæƒå›è·¯**ã€‚ä½†ä¸€èˆ¬ä¸ç”¨ä»–æ¥åšï¼Œä½¿ç”¨ spfa æ¥åš
* æ—¶é—´å¤æ‚åº¦ O(nm)

**ç®—æ³•æµç¨‹**

```C++
for k from 1 to n // n æ¬¡
    // æ³¨æ„è¿™é‡Œçš„ k å…·æœ‰å®é™…çš„æ„ä¹‰
    // éå†æ‰€æœ‰è¾¹
    for all edges: a, b, w  // m æ¬¡ å­˜è¾¹çš„æ–¹å¼éšä¾¿å­˜
        // æ¾å¼›æ“ä½œ
        dist[b] = min(dist[b], dist[a] + w)  // æ›´æ–°è·ç¦»
```

**æ³¨æ„**
- ç¬¬ä¸€å±‚å¾ªç¯ä¸­ **k** çš„å®é™…å«ä¹‰ï¼šå¾ªç¯ **k æ¬¡** åæ±‚å¾—çš„æœ€çŸ­è·ç¦»æ˜¯ï¼Œç»è¿‡ **ä¸è¶…è¿‡ k æ¡è¾¹** èµ°åˆ°æ¯ä¸€ä¸ªç‚¹çš„æœ€çŸ­è·ç¦»
- å½“ **k == n** æ—¶ï¼Œå¦‚æœå‘ç”Ÿæ›´æ–°ï¼Œåˆ™æ„å‘³ç€**å­˜åœ¨ä¸€æ¡é•¿åº¦ä¸º n çš„è¾¹ï¼ˆä¹Ÿæ˜¯ä¸€ä¸ªç¯ï¼‰æ›´æ–°äº†æœ€çŸ­è·ç¦»**ã€‚é‚£è¿™**ä¸€å®šæ˜¯ä¸€ä¸ªè´Ÿç¯**
- æ‰§è¡Œ bellman-ford ç®—æ³•åï¼Œæ‰€æœ‰ç‚¹æ»¡è¶³ `dist[b] <= dist[a] + w`ï¼Œè¿™ä¸ªæ˜¯ä¸‰è§’ä¸ç­‰å¼ã€‚

[853. æœ‰è¾¹æ•°é™åˆ¶çš„æœ€çŸ­è·¯](https://www.acwing.com/problem/content/855/)

```C++
const int N = 507, M = 10007;
struct Edge {
    int a, b, w;
} edges[M];  // M æ¡è¾¹

int n, m, k;
int dist[N], last[N];

void bellman_ford() {
    // åˆå§‹åŒ–
    memset(dist, 0x3f, sizeof dist);
    dist[1] = 0;  // æ³¨æ„è¦åˆå§‹åŒ–èµ·ç‚¹è·ç¦»ä¸º 0

    // éå† k æ¬¡
    for (int i = 0; i < k; i++) {
        // å¤‡ä»½ä¸Šä¸€æ¬¡çš„æ¾å¼›ç»“æœ æ”¾ç½®å‘ç”Ÿä¸²è”
        memcpy(last, dist, sizeof dist);
        // éå†æ‰€æœ‰çš„è¾¹
        for (int j = 0; j < m; j++) {
            auto e = edges[j];
            dist[e.b] = min(dist[e.b], last[e.a] + e.w);
        }
    }
}

int main() {
    // å­˜è¾¹
    cin >> n >> m >> k;
    for (int i = 0; i < m; i++) {
        int a, b, w;
        cin >> a >> b >> w;
        edges[i] = {a, b, w};
    }

    // bellman-ford ç®—æ³•
    bellman_ford();
    // æ³¨æ„è¿™é‡Œæ˜¯ 0x3f3f3f3f / 2 å› ä¸º +inf å¯èƒ½ä¼šè¢«è´Ÿæƒæ›´æ–°
    if (dist[n] > 0x3f3f3f3f / 2) cout << "impossible" << endl;
    else cout << dist[n] << endl;

    return 0;
}
```

## SPFA ç®—æ³•

**SPFA**ï¼šè§£å†³åœ¨ **å«è´Ÿæƒä½†æ˜¯ä¸å«è´Ÿç¯** çš„å›¾ä¸­æ±‚ **æœ€çŸ­è·¯**

- **SPFA** ç®—æ³•æ˜¯å¯¹ bellman-ford ç®—æ³•çš„ä¼˜åŒ–ã€‚bellman-ford ç®—æ³•ä¸­æ›´æ–°è·ç¦» `dist[b] = min(dist[b], dist[a] + w)` æ˜¯å†—ä½™çš„ã€‚å¾ˆå¤šæƒ…å†µä¸‹ `dist[b]` ä¸ä¼šæ›´æ–°ï¼Œåªæœ‰ `dist[a]` æ›´æ–°ä¹‹å `dist[b]` æ‰æœ‰å¯èƒ½æ›´æ–°  

**SPFA** ç®—æ³•ä½¿ç”¨ä¸€ä¸ª **é˜Ÿåˆ—ï¼ˆå®½æœæ€æƒ³ï¼‰è¿›è¡Œä¼˜åŒ–**ã€‚é˜Ÿåˆ—ä¸­å­˜æ”¾ **æ‰€æœ‰æœ€çŸ­è·¯å˜å°çš„èŠ‚ç‚¹** ç”¨äºæ›´æ–°å…¶ä»–ç‚¹

**ç®—æ³•æµç¨‹ï¼ˆå’Œ dijkstra ç±»ä¼¼ï¼‰**

```C++
queue <- 1  // æ”¾å…¥èµ·ç‚¹ è¡¨ç¤ºèµ·ç‚¹è·ç¦»å˜å°äº†
while queue not emptyï¼š// é˜Ÿåˆ—ä¸ç©º
    t <- q.front // æ‹¿åˆ°é˜Ÿå¤´èŠ‚ç‚¹ t
    q.pop // å‡ºé˜Ÿ

    // æ›´æ–° t çš„æ‰€æœ‰å‡ºè¾¹ï¼št -> b, æƒé‡ w
    q <- b  // æŠŠ b æ”¾å…¥é˜Ÿåˆ—ã€‚
    // æ³¨æ„é˜²æ­¢é˜Ÿåˆ—å­˜é‡å¤çš„ç‚¹ æ²¡æœ‰æ„ä¹‰
    // æ›´æ–°è¿‡çš„æ”¾ä¸€æ¬¡å°±è¡Œäº†
```
     
**æ—¶é—´å¤æ‚åº¦**ï¼šå¹³å‡ `O(m)` æœ€å `O(nm)`

[851. spfaæ±‚æœ€çŸ­è·¯](https://www.acwing.com/problem/content/853/)

```C++
void spfa() {
    memset(dist, 0x3f, sizeof dist);
    dist[1] = 0;

    queue<int> q;
    q.push(1);
    st[1] = true;

    while (q.size()) {
        int t = q.front();
        q.pop();
        st[t] = false;

        // éå† t çš„è¾¹
        for (int i = h[t]; ~i; i = ne[i]) {
            int j = e[i];
            if (dist[j] > dist[t] + w[i]) {
                dist[j] = dist[t] + w[i];  // å…ˆæ›´æ–°
                if (!st[j]) {  // èƒ½ä¸èƒ½æ”¾å…¥ j
                    q.push(j);
                    st[j] = true; 
                }
            }
        }
    }
}
```

[852. spfaåˆ¤æ–­è´Ÿç¯](https://www.acwing.com/problem/content/854/)

**åˆ¤æ–­æ˜¯å¦å…·æœ‰è´Ÿç¯**
* `dist` æ•°ç»„è¡¨ç¤º **å½“å‰æœ€çŸ­è·¯è·ç¦»**
* `cnt` æ•°ç»„è¡¨ç¤º **è¾¹æ•°**

**æ›´æ–°å…¬å¼**
* `dist[x] = dist[t] + w[i]`
* `cnt[x] = cnt[t] + 1`
* if `cnt[x] >= n` æ„å‘³ç€å­˜åœ¨è´Ÿç¯

**æ³¨æ„ï¼š**
* `dist` æ•°ç»„èµ‹å€¼ä¸º 0 ä¸ç­‰äºæ²¡èµ‹å€¼ã€‚èµ‹å€¼ä¸º 0 æ„æ€æ˜¯è™šæ‹Ÿä¸€ä¸ª**èµ·å§‹æºç‚¹**ã€‚è¿™ä¸ª**æºç‚¹åˆ°å…¶ä»–ç‚¹çš„è·ç¦»ä¸º 0**ï¼Œç„¶å**æ•ˆæœç­‰ä»·äºåˆå§‹æ—¶æŠŠå„ä¸ªç‚¹åŠ åˆ°é˜Ÿåˆ—ä¸­**
* ä¸ç®¡ `dist` æ•°ç»„çš„**åˆå€¼æ˜¯å¤šå°‘ï¼Œéƒ½æ˜¯å¯ä»¥çš„**ã€‚å› ä¸ºåªè¦æœ‰è´Ÿç¯å­˜åœ¨ï¼Œå°±å¿…ç„¶æœ‰æŸäº›ç‚¹çš„è·ç¦»æ˜¯è´Ÿæ— ç©·ã€‚æ‰€ä»¥ä¸ç®¡è·ç¦»è¢«åˆå§‹åŒ–æˆä½•å€¼ï¼Œéƒ½ä¸€å®šä¸¥æ ¼å¤§äºè´Ÿæ— ç©·ï¼Œæ‰€ä»¥ä¸€å®šä¼šè¢«æ— é™æ›´æ–°ã€‚

```C++
bool spfa() {
    queue<int> q;
    for (int i = 1; i <= n; i++) {
        q.push(i);
        st[i] = true;
    }
    
    while (q.size()) {
        int t = q.front();
        q.pop();
        st[t] = false;

        // éå† t çš„è¾¹
        for (int i = h[t]; ~i; i = ne[i]) {
            int j = e[i];
            if (dist[j] > dist[t] + w[i]) {
                dist[j] = dist[t] + w[i];
                cnt[j] = cnt[t] + 1;

                if (cnt[j] >= n) {
                    return true;
                }
                if (!st[j]) {  // èƒ½ä¸èƒ½æ”¾å…¥ j
                    q.push(j);
                    st[j] = true; 
                }
            }
        }
    }
    return false;
}
```

## Floyd ç®—æ³•

Floyd ç®—æ³•ï¼Œ**æ±‚è§£å¤šæºæœ€çŸ­è·¯**

* å¤šæºæœ€çŸ­è·¯ **æœ¬è´¨æ˜¯åŠ¨æ€è§„åˆ’**
* é€‚ç”¨äºä»»ä½•å›¾ï¼Œ**ä¸ç®¡æœ‰å‘æ— å‘ï¼Œè¾¹æƒæ­£è´Ÿ**ï¼Œä½†æ˜¯**æœ€çŸ­è·¯å¿…é¡»å­˜åœ¨**ã€‚ï¼ˆä¸èƒ½æœ‰ä¸ªè´Ÿç¯ï¼‰
* yæ€»ï¼šFloyd è¶…ç®€å• **ä¸‰é‡ for å¾ªç¯**ï¼Œæ—¶é—´å¤æ‚åº¦ï¼š`O(n^3)`
* ç›´æ¥å»ºç«‹ **é‚»æ¥çŸ©é˜µ** å­˜å›¾
* åˆå§‹æ—¶ï¼Œ`d[i][j]` å­˜è¾¹ï¼›æœ€ç»ˆï¼Œ`d[i][j]` å­˜æœ€çŸ­è·¯ã€‚**é‚»æ¥çŸ©é˜µç›´æ¥å˜æˆæœ€çŸ­è·ç¦»çŸ©é˜µ**

**ç®—æ³•æµç¨‹**

```C++
 for k from 1 to n:  // èŠ‚ç‚¹ k
     for i from 1 to n:  // èŠ‚ç‚¹ i
         for j from 1 to n:  // èŠ‚ç‚¹ j
             d[i][j] = min(d[i][j], d[i][k] + d[k][j])
```

[854. Floydæ±‚æœ€çŸ­è·¯](https://www.acwing.com/problem/content/856/)

```C++
const int N = 207, INF = 1e9;
int n, m, k;
int d[N][N];

// floyd ç®—æ³•
void floyd() {
    for (int k = 1; k <= n; k++) {
        for (int i = 1; i <= n; i++) {
            for (int j = 1; j <= n; j++) {
                d[i][j] = min(d[i][j], d[i][k] + d[k][j]);
            }
        }
    }
}

int main() {
    cin >> n >> m >> k;
    // åˆå§‹åŒ– é‚»æ¥çŸ©é˜µ
    for (int i = 1; i <= n; i++) {
        for (int j = 1; j <= n; j++) {
            if (i == j) d[i][j] = 0;
            else d[i][j] = INF;
        }
    }
    while (m--) {
        int a, b, c;
        cin >> a >> b >> c;
        d[a][b] = min(d[a][b], c);
    }

    // Floyd ç®—æ³•
    floyd();

    // æŸ¥è¯¢
    while (k--) {
        int a, b;
        cin >> a >> b;
        if (d[a][b] > INF / 2) cout << "impossible" << endl;
        else cout << d[a][b] << endl;
    }
    return 0;
}
```

## æœ€å°ç”Ÿæˆæ ‘

**å®šä¹‰**ï¼šç»™å®šä¸€ä¸ªçš„æ— å‘å›¾ G = (V, E) ï¼ˆå›¾ä¸­å¯èƒ½å­˜åœ¨é‡è¾¹å’Œè‡ªç¯ï¼Œè¾¹æƒå¯èƒ½ä¸ºè´Ÿæ•°ï¼‰ã€‚å…¶ä¸­ **V è¡¨ç¤ºå›¾ä¸­ç‚¹çš„é›†åˆ**ï¼Œ**E è¡¨ç¤ºå›¾ä¸­è¾¹çš„é›†åˆ** n = |V| m = |E|ã€‚ç”± V ä¸­çš„å…¨éƒ¨ n ä¸ªé¡¶ç‚¹å’Œ E ä¸­ **nâˆ’1 æ¡è¾¹æ„æˆçš„æ— å‘è¿é€šå­å›¾**è¢«ç§°ä¸º **G çš„ä¸€æ£µç”Ÿæˆæ ‘**ï¼Œå…¶ä¸­**è¾¹çš„æƒå€¼ä¹‹å’Œæœ€å°çš„ç”Ÿæˆæ ‘è¢«ç§°ä¸ºæ— å‘å›¾ G çš„æœ€å°ç”Ÿæˆæ ‘**ã€‚

### Prim ç®—æ³•

ä¸ dijkstra ç®—æ³•ç±»ä¼¼
- **æœ´ç´  Prim ç®—æ³•**ï¼šé€‚ç”¨äº **ç¨ å¯†å›¾**ï¼Œæ—¶é—´å¤æ‚åº¦ `O(n^2)` 
- **å †ä¼˜åŒ– Prim ç®—æ³•**ï¼šé€‚ç”¨äº **ç¨€ç–å›¾**ï¼Œæ—¶é—´å¤æ‚åº¦ `O(mlogn)`ã€‚ä¸å¤ªå¸¸ç”¨

### Kruskal ç®—æ³•

é€‚ç”¨äº **ç¨€ç–å›¾**ï¼Œæ—¶é—´å¤æ‚åº¦ `O(mlogm) = O(mlogn)`

## æœ´ç´  Prim ç®—æ³•

**ç®—æ³•æµç¨‹**
1. æ‰€æœ‰ **è·ç¦»åˆå§‹åŒ–** ä¸º **æ­£æ— ç©·**ï¼š`dist[N] = +inf`ã€‚è·ç¦»è¡¨ç¤ºï¼šä¸åœ¨ MST ä¸­çš„ç‚¹åˆ° MST çš„è·ç¦»
2. `n` æ¬¡è¿­ä»£
    ```C++
    for (int i = 0; i < n; i++)
        t <- for() // æ¯æ¬¡æ‰¾åˆ° ä¸åœ¨ MST ä¸­çš„ è·ç¦»ç”Ÿæˆæ ‘æœ€è¿‘ çš„ç‚¹ t
        dist[i] <- t // ç”¨ t æ›´æ–°å…¶ä»–ç‚¹ i åˆ°ç”Ÿæˆæ ‘çš„è·ç¦»
        st[t] = true // æŠŠ t æ”¾å…¥é›†åˆ
    ```

[858. Primç®—æ³•æ±‚æœ€å°ç”Ÿæˆæ ‘](https://www.acwing.com/problem/content/860/)

```C++
const int N = 507, INF = 0x3f3f3f3f;

int n, m, g[N][N], dist[N];
bool st[N];

int prim() {
    memset(dist, 0x3f, sizeof dist);
    
    int res = 0;
    for (int i = 0; i < n; i++) {
        int t = -1;
        for (int j = 1; j <= n; j++) {
            if (!st[j] && (t == -1 || dist[t] > dist[j]))
                t = j;
        }
        if (i && dist[t] == INF) return INF;
        if (i) res += dist[t];
        
        for (int j = 1; j <= n; j++) {
            dist[j] = min(dist[j], g[t][j]);
        }
        st[t] = true;
    }
    return res;
}

int main() {
    
    cin >> n >> m;
    memset(g, 0x3f, sizeof g);
    for (int i = 0; i < m; i++) {
        int u, v, w;
        cin >> u >> v >> w;
        g[v][u] = g[u][v] = min(g[u][v], w);
    }
    
    int res = prim();
    
    if (res == INF) cout << "impossible";
    else cout << res;
    
    return 0;
}
```

## Kruskal ç®—æ³•

**ç®—æ³•æµç¨‹**
- å°† **æ‰€æœ‰è¾¹** æŒ‰ç…§è¾¹æƒ **ä»å°åˆ°å¤§æ’åº**
- æšä¸¾æ¯æ¡è¾¹ `a->b`ï¼Œæƒé‡ `c`
    * å¦‚æœ `a` å’Œ `b` ä¸è¿é€šï¼Œä½¿ç”¨ **å¹¶æŸ¥é›†** æŠŠ `a` å’Œ `b` è”é€šï¼ŒåŒæ—¶ç»´æŠ¤ MST çš„æƒé‡

**æ—¶é—´å¤æ‚åº¦** `mlogm`ã€‚ä¸»è¦æ˜¯å¯¹è¾¹æ’åºçš„æ—¶é—´

[859. Kruskalç®—æ³•æ±‚æœ€å°ç”Ÿæˆæ ‘](https://www.acwing.com/problem/content/861/)

```C++
const int N = 1e5+7, M = 2e5+7;

struct edge {
    int a, b, c;
    bool operator < (const edge& x) const {
        return this->c < x.c;
    }
} e[M];

int n, m;
int p[N];

int find(int x) {
    if (p[x] != x) p[x] = find(p[x]);
    return p[x];
}

int main() {
    cin >> n >> m;
    for (int i = 1; i <= n; i++) p[i] = i;
    for (int i = 0; i < m; i++) {
        cin >> e[i].a >> e[i].b >> e[i].c; 
    }
    
    sort(e, e+m);
    int res = 0, cnt = 0;
    for (int i = 0; i < m; i++) {
        auto [a, b, c] = e[i];
        a = find(a), b = find(b);
        if (a == b) continue;
        res += c;
        cnt++;
        p[a] = b;
    }
    
    if (cnt < n-1) cout << "impossible";
    else cout << res;
    return 0;
}
```

## åˆ¤æ–­äºŒåˆ†å›¾

**åˆ¤æ–­äºŒåˆ†å›¾ï¼šæŸ“è‰²æ³•**ï¼Œæ—¶é—´å¤æ‚åº¦ `O(m+n)`

**æ€§è´¨**ï¼šä¸€ä¸ªå›¾æ˜¯äºŒåˆ†å›¾ï¼Œå½“ä¸”ä»…å½“å›¾å½“ä¸­ **ä¸å«æœ‰å¥‡æ•°ç¯**ã€‚ç”±äºä¸å«å¥‡æ•°ç¯ï¼ŒæŸ“è‰²è¿‡ç¨‹ä¸­ä¸ä¼šå‡ºç°çŸ›ç›¾ã€‚ä½¿ç”¨ **æ·±æœæˆ–è€…å®½æœ** è¿›è¡ŒæŸ“è‰²

```C++
// dfs å†™æ³•
const int N = 1e5 + 7, M = 2 * N;  // æ³¨æ„æ— å‘å›¾çš„è¾¹æ•°
int n, m, color[N];
int h[N], e[M], ne[M], idx;

void add(int a, int b) {
    e[idx] = b;
    ne[idx] = h[a];
    h[a] = idx++;
}

// æ·±æœåˆ¤æ–­èƒ½å¦äºŒåˆ†å›¾
bool dfs(int u, int c) {
    color[u] = c;  // æŸ“è‰²
    // dfs æŸ“è‰²å­èŠ‚ç‚¹
    for (int i = h[u]; ~i; i = ne[i]) {
        int j = e[i];
        if (color[j] == 0) {
            if (!dfs(j, 3 - c)) return false;
        } else {
            if (color[j] == c) return false;
        }
    }
    return true;
}

int main() {
    // å»ºå›¾
    cin >> n >> m;
    memset(h, -1, sizeof h);
    while (m--) {
        int a, b;
        cin >> a >> b;
        add(a, b);
        add(b, a);
    }
    // å¤šæº dfs
    bool flag = true;
    for (int i = 1; i <= n; i++) {
        // å¯¹æ²¡æŸ“è¿‡è‰²çš„ç‚¹è¿›è¡ŒæŸ“è‰² åŒæ—¶åˆ¤æ–­åˆæ³•æ€§
        if (color[i] == 0) {
            if (!dfs(i, 1)) flag = false;
        }
    }
    if (flag) cout << "Yes" << endl;
    else cout << "No" << endl;
    return 0;
}
```

## åŒˆç‰™åˆ©ç®—æ³•

åŒˆç‰™åˆ©ç®—æ³• **æ±‚æœ€å¤§åŒ¹é…**ã€‚äºŒåˆ†å›¾ä¸­æ»¡è¶³è¦æ±‚çš„æœ€å¤§åŒ¹é…æ•°

æ—¶é—´å¤æ‚åº¦ `O(nm)` ä½†æ˜¯ä¸€èˆ¬è·‘ä¸åˆ°

```C++
const int N = 507, M = 1e5 + 7;
int n1, n2, m;
// ä½¿ç”¨ é‚»æ¥è¡¨ å­˜ ç”·ç”ŸæŒ‡å‘å¥³ç”Ÿçš„è¾¹
int h[N], e[M], ne[M], idx;
int match[N];  // å­˜æ”¾æ¯ä¸ª å¥³ç”Ÿ çš„åŒ¹é…ç»“æœ
bool st[N];  // ä¸ºæ¯æ¬¡æ‰¾ å·²åˆ†é…çš„ç”·ç”Ÿ çš„å¤‡èƒç”¨
void add(int a, int b) {
    e[idx] = b, ne[idx] = h[a], h[a] = idx++;
}
bool find(int boy) {
    // éå†ç”·ç”Ÿèƒ½åŒ¹é…çš„å¥³ç”Ÿ
    for (int i = h[boy]; ~i; i = ne[i]) {
        int girl = e[i];
        if (!st[girl]) { // å¥³ç”Ÿåœ¨ä¸€æ¬¡ find ä¸­è¿˜æ²¡æœ‰è¢«åˆ†é…      
            st[girl] = true;  // åˆ†é…
            // çœ‹çœ‹
            if (!match[girl] || find(match[girl])) {
                match[girl] = boy;
                return true;
            }
        }
    }
    return false;
}
int main() {
    // é‚»æ¥è¡¨
    cin >> n1 >> n2 >> m;
    memset(h, -1, sizeof h);
    while (m--) {
        int boy, girl;
        cin >> boy >> girl;
        add(boy, girl);
    }

    // æ‰¾åŒ¹é…
    int ans = 0;
    for (int boy = 1; boy <= n1; boy++) {
        // æ¯æ¬¡é‡ç½®
        memset(st, false, sizeof st);
        if (find(boy)) {
            ans++;
        }
    }
    cout << ans << endl;
    return 0;
}
```





