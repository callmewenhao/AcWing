# 状态压缩 DP

分类：
- 棋盘式（基于连通性）相对来说比较简单，考虑每一行或者列的状态选取
- 集合

[1064. 小国王](https://www.acwing.com/problem/content/1066/)

棋盘式（基于连通性）的状态压缩 DP

井字型区域内都不能放置国王

状态表示 `f[i][j][s]`：
- 集合：所有只摆在前 i 行，已经摆了 j 个国王，并且第 i 行摆放的状态是 s 的所有方案集合
- 属性：数量

状态计算：
- 判断来两个相邻状态是否合法 (a, b)：
    - 第 i 和 i-1 行内部不能有两个相邻的 1
    - 第 i 行和 i-1 行不能相互攻击到：`a&b==0` && `(a|b) 不能有相邻 1`
- 已经摆完了前 i 行，并且第 i 排的状态是 a，第 i-1 排的状态是 b，已经摆了 j 个国王的所有方案，来自于
- 已经摆完了前 i-1 行，并且第 i-1 排的状态是 a，已经摆了 j-count(a) 个国王的所有方案
- 也即，`f[i][j][a] += f[i-1][j-count(a)][b]`

初始化：`f[0][0][0] = 1`，初始时，摆完了前 0 行，摆了 0 个，状态为 0 的数量是 1

答案：`f[n][m][所有合法状态] = f[n+1][m][0]`，也就是摆 n+1 行，但是第 n+1 行一个也没摆

时间复杂度：
- 状态数量 * 状态转移计算量 = 行数 * 要摆的国王数 * 合法状态数 * 合法的可转移来的状态数
= 10 * 100 * 1000 * 1000 = 1e9
- 但是 **合法状态数** 不会到 1000，同样 **合法状态数 * 合法的可转移来的状态数** 最大是 1365
- 所以理论上的时间复杂度 = 10 * 100 * 1365

[327. 玉米田](https://www.acwing.com/problem/content/329/)

十字型区域内不能够种玉米

状态表示 `f[i][s]`：
- 集合：所有已经摆完前 i 行，且第 i 行的状态是 s 的所有摆放方案集合
- 属性：数量

状态计算：
- 相邻两行的状态（a, b）要满足的条件：
    - a，b 的二进制表示中不包含连续的 1
    - (a & b) == 0 保正行间位置不能同时种玉米
- 已经摆完前 i 行，且第 i 行的状态是 a，第 i-1 行的状态是 b 的所有摆放方案，来自于 
- 已经摆完前 i-1 行，且第 i-1 行的状态是 b 的所有摆放方案

时间复杂度：n*2^n*2^n = 12 * 2^12 * 2^12 = 1e8，因为位置有限制，做不到 1e8

[292. 炮兵阵地](https://www.acwing.com/problem/content/294/)

大十字型区域内不能够种玉米

状态表示 f[i][j][k]：
- 集合：所有已经摆完前 i 行，且第 i-1 行的状态是 j，第 i 行状态是 k 的所有摆放方案
- 属性：最大值

状态计算：
- 假设第 i-1 行是 a，第 i 行是 b，第 i-2 行是 c，则
    - 保证相互不攻击 ((a&b) | (a&c) | (b&c)) == 0
    - 保证炮部署在平地 (g[i-1] & a | g[i] & b) == 0

时间复杂度：
- 状态数量：n * 2^m * 2^m
- 转移计算量：2^m
- 总复杂度：n * 2^m * 2^m * 2^m = 1e9，但是限制很多，有效的状态非常少，可以过




