# 状态机模型

状态机：状态机可以描述一系列 **有序** 的事件之间的转换

[1049. 大盗阿福](https://www.acwing.com/problem/content/1051/)

非常经典的状态机 dp 题目

**线性 dp：**

状态表示 `f[i]`：
- 所有从前 i 家店铺中抢的方案
- 最大值

状态计算：
- 不选第 i 家店：`f[i-1]`
- 选第 i 家店：`f[i-2] + a[i]`
- `f[i] = max(f[i-1], f[i-2] + a[i])`

**状态机 dp：**

为每一家店铺设置两种状态 0 和 1，也即 `f[i] to f[i][0] && f[i][1]`：
- `f[i][0]`：表示第 i 家店铺没被抢的最大值
- `f[i][1]`：表示第 i 家店铺被抢了的最大值

分析状态机模型：
- `f[i][0] to f[i+1][0]`：当前位置的 0 状态可以到达下一位置的 0 状态
- `f[i][0] to f[i+1][1]`：当前位置的 0 状态可以到达下一位置的 1 状态
- `f[i][1] to f[i+1][0]`：当前位置的 1 状态可以到达下一位置的 0 状态
- `f[i][1] not to f[i+1][1]`：当前位置的 1 状态无法到达下一位置的 1 状态

状态计算：
- `f[i+1][0] = max(f[i][0], f[i][1])`
- `f[i+1][1] = f[i][0]`

状态机的入口：
- `f[0][0] = 0`：不选入口节点就是 0
- `f[0][1] = -inf`：选入口节点，但是入口节点没有意义，用负无穷表示

答案是两种状态的最大值：`max(f[n][0], f[n][1])`

[1057. 股票买卖 IV](https://www.acwing.com/problem/content/1059/)

定义状态：
- 手中有股票
- 手中没股票

状态机模型：
- 手中有股票 to 手中无股票：卖掉股票，钱数增加
- 手中有股票 to 手中有股票：总钱数不变
- 手中无股票 to 手中无股票：总钱数不变
- 手中无股票 to 手中有股票：买入股票，钱数减少

状态表示 `f[i][j][0] && f[i][j][1]`：
- 集合：前 i 天，正在进行 j 次交易（注意不是已经完成了 j 次），并且手上有无货的方案
- 属性：钱数最大值

状态计算：
- `f[i][j][0] = max(f[i-1][j][0], f[i-1][j][1] + w[i])  // w[i] 是价格`
- `f[i][j][1] = max(f[i-1][j][1], f[i-1][j-1][0] - w[i])`

初始化：手中无货，因此 `f[i][0][0] = 0 && f[i][0][1] = -inf`
- 注意：一般把不可能的状态初始化成 `-inf`

[1058. 股票买卖 V](https://www.acwing.com/problem/content/1060/)

状态更加复杂。为了实现卖出的第二天不能买入，需要把之前手中无货的状态继续细分，这样一共三种状态：
- 无货第一天，`f[i][1]`
- 无货大于一天，`f[i][2]`
- 手中有货，`f[i][0]`

状态机模型：
- 手中有货 to 手中有货，钱数不变
- 手中有货 to 无货第一天，钱数增加当天股票价格
- 无货第一天 to 无货大于一天，钱数不变
- 无货大于一天 to 无货大于一天，钱数不变
- 无货大于一天 to 手中有货，钱数减少当天股票价格

状态机入口：
- 手中无货大于一天。因为刚开始手中无货，并且可以购买股票

状态机出口：
- 无货第一天，表示当天卖的股票
- 无货大于一天，表示之前卖的股票

状态计算：
- `f[i][0] = max(f[i-1][0], f[i-1][2] - w[i]) `
- `f[i][1] = f[i-1][0] + w[i]`  
- `f[i][2] = max(f[i-1][1], f[i-1][2])`

初始化：
- 入口初始化成 0
- 其余不合法的状态初始化成负无穷

[1052. 设计密码](https://www.acwing.com/problem/content/1054/)

> AC 自动机 == trie + KMP，高级数据结构

这个题目比较难，是 KMP 和状态机的结合

状态表示 f[i][j]：长度为 i 的字符串中，（最后这个字符）成功匹配个数为 j 的字符串个数
- 第一维大小就是 N，表示字符串长度
- 第二维大小是 M+1，也就是成功匹配的个数

时间复杂度是 `26*N^2`，这里因为 N 不大，y 总就没预处理，直接暴力枚举 `26*N^3`
